% Интерполяция сплайнами F1 равномерная сетка (n = 3)
dot_x=[-1  0  1];
dot_y=[1  0  1];

x = [-1:0.01:1];
y = x.^2;
plot(x,y,'r');
hold on

x=[-1:0.01:1];
y=[1  0.9801  0.9604  0.9409  0.9216  0.9025  0.8836  0.8649  0.8464  0.8281  0.81  0.7921  0.7744  0.7569  0.7396  0.7225  0.7056  0.6889  0.6724  0.6561  0.64  0.6241  0.6084  0.5929  0.5776  0.5625  0.5476  0.5329  0.5184  0.5041  0.49  0.4761  0.4624  0.4489  0.4356  0.4225  0.4096  0.3969  0.3844  0.3721  0.36  0.3481  0.3364  0.3249  0.3136  0.3025  0.2916  0.2809  0.2704  0.2601  0.25  0.2401  0.2304  0.2209  0.2116  0.2025  0.1936  0.1849  0.1764  0.1681  0.16  0.1521  0.1444  0.1369  0.1296  0.1225  0.1156  0.1089  0.1024  0.0961  0.09  0.0841  0.0784  0.0729  0.0676  0.0625  0.0576  0.0529  0.0484  0.0441  0.04  0.0361  0.0324  0.0289  0.0256  0.0225  0.0196  0.0169  0.0144  0.0121  0.01  0.0081  0.0064  0.0049  0.0036  0.0025  0.0016  0.0009  0.0004  0.0001  0  0.0001  0.0004  0.0009  0.0016  0.0025  0.0036  0.0049  0.0064  0.0081  0.01  0.0121  0.0144  0.0169  0.0196  0.0225  0.0256  0.0289  0.0324  0.0361  0.04  0.0441  0.0484  0.0529  0.0576  0.0625  0.0676  0.0729  0.0784  0.0841  0.09  0.0961  0.1024  0.1089  0.1156  0.1225  0.1296  0.1369  0.1444  0.1521  0.16  0.1681  0.1764  0.1849  0.1936  0.2025  0.2116  0.2209  0.2304  0.2401  0.25  0.2601  0.2704  0.2809  0.2916  0.3025  0.3136  0.3249  0.3364  0.3481  0.36  0.3721  0.3844  0.3969  0.4096  0.4225  0.4356  0.4489  0.4624  0.4761  0.49  0.5041  0.5184  0.5329  0.5476  0.5625  0.5776  0.5929  0.6084  0.6241  0.64  0.6561  0.6724  0.6889  0.7056  0.7225  0.7396  0.7569  0.7744  0.7921  0.81  0.8281  0.8464  0.8649  0.8836  0.9025  0.9216  0.9409  0.9604  0.9801  1];
plot(x,y,'b');

plot(dot_x,dot_y,'r--');

for i = 1:3
    plot(dot_x(i), dot_y(i), 'r.','MarkerSize', 10);
end


title('F1 Spline Interpolation uniform grid');
legend({'y = x^2', 'Spline', 'y = x^2, grid', 'Uniform grid n = 3'}, 'Location', 'southeast');

%  xlim ([-3.1 3.1]);
%  ylim ([-0.1 3.1]);

grid on;
hold off

% Интерполяция сплайнами F1 равномерная сетка (n = 10)
figure;
dot_x = [-1  -0.777778  -0.555556  -0.333333  -0.111111  0.111111  0.333333  0.555556  0.777778  1];
dot_y = [1  0.604938  0.308642  0.111111  0.0123457  0.0123457  0.111111  0.308642  0.604938  1];

x = [-1:0.01:1];
y = x.^2;
plot(x,y,'r');
hold on

x=[-1:0.01:1];
y=[1  0.979902  0.960006  0.940315  0.920832  0.901558  0.882496  0.863649  0.845018  0.826607  0.808417  0.790452  0.772713  0.755203  0.737924  0.720879  0.704071  0.687501  0.671171  0.655086  0.639246  0.623654  0.608313  0.592649  0.577071  0.561741  0.546656  0.531813  0.51721  0.502842  0.488707  0.474802  0.461124  0.447669  0.434435  0.421418  0.408617  0.396026  0.383644  0.371467  0.359493  0.347718  0.336139  0.324753  0.313558  0.302549  0.291727  0.281091  0.270643  0.260384  0.250314  0.240435  0.230746  0.221249  0.211945  0.202835  0.193918  0.185197  0.176671  0.168343  0.160211  0.152278  0.144545  0.137011  0.129678  0.122547  0.115618  0.108892  0.10237  0.0960511  0.0899358  0.0840237  0.0783143  0.0728077  0.0675036  0.0624017  0.0575019  0.052804  0.0483078  0.044013  0.0399195  0.036027  0.0323354  0.0288445  0.025554  0.0224637  0.0195734  0.016883  0.0143923  0.0121009  0.0100089  0.00811602  0.00642244  0.0049281  0.003633  0.00253715  0.00164055  0.000943191  0.000445078  0.00014621  4.65875e-05  0.00014621  0.000445078  0.000943191  0.00164055  0.00253715  0.003633  0.0049281  0.00642244  0.00811602  0.0100089  0.0121009  0.0143923  0.016883  0.0195734  0.0224637  0.025554  0.0288445  0.0323354  0.036027  0.0399195  0.044013  0.0483078  0.052804  0.0575019  0.0624017  0.0675036  0.0728077  0.0783143  0.0840237  0.0899358  0.0960511  0.10237  0.108892  0.115618  0.122547  0.129678  0.137011  0.144545  0.152278  0.160211  0.168343  0.176671  0.185197  0.193918  0.202835  0.211945  0.221249  0.230746  0.240435  0.250314  0.260384  0.270643  0.281091  0.291727  0.302549  0.313558  0.324753  0.336139  0.347718  0.359493  0.371467  0.383644  0.396026  0.408617  0.421418  0.434435  0.447669  0.461124  0.474802  0.488707  0.502842  0.51721  0.531813  0.546656  0.561741  0.577071  0.592649  0.608313  0.623654  0.639246  0.655086  0.671171  0.687501  0.704071  0.720879  0.737924  0.755203  0.772713  0.790452  0.808417  0.826607  0.845018  0.863649  0.882496  0.901558  0.920832  0.940315  0.960006  0.979902  1];
plot(x,y,'b');

plot(dot_x,dot_y,'r--');

for i = 1:10
    plot(dot_x(i), dot_y(i), 'r.','MarkerSize', 10);
end

title('F1 Spline Interpolation uniform grid');
legend({'y = x^2', 'Spline', 'y = x^2, grid', 'Uniform grid n = 10'}, 'Location', 'southeast');

%  xlim ([-1.1 1.1]);
%  ylim ([-0.1 1.1]);

grid on;
hold off

% Интерполяция сплайнами F1 равномерная сетка (n = 50)
figure;
dot_x=[-1  -0.959184  -0.918367  -0.877551  -0.836735  -0.795918  -0.755102  -0.714286  -0.673469  -0.632653  -0.591837  -0.55102  -0.510204  -0.469388  -0.428571  -0.387755  -0.346939  -0.306122  -0.265306  -0.22449  -0.183673  -0.142857  -0.102041  -0.0612245  -0.0204082  0.0204082  0.0612245  0.102041  0.142857  0.183673  0.22449  0.265306  0.306122  0.346939  0.387755  0.428571  0.469388  0.510204  0.55102  0.591837  0.632653  0.673469  0.714286  0.755102  0.795918  0.836735  0.877551  0.918367  0.959184  1];
dot_y=[1  0.920033  0.843399  0.770096  0.700125  0.633486  0.570179  0.510204  0.453561  0.40025  0.350271  0.303623  0.260308  0.220325  0.183673  0.150354  0.120367  0.093711  0.0703873  0.0503957  0.0337359  0.0204082  0.0104123  0.00374844  0.000416493  0.000416493  0.00374844  0.0104123  0.0204082  0.0337359  0.0503957  0.0703873  0.093711  0.120367  0.150354  0.183673  0.220325  0.260308  0.303623  0.350271  0.40025  0.453561  0.510204  0.570179  0.633486  0.700125  0.770096  0.843399  0.920033  1];

x = [-1:0.01:1];
y = x.^2;
plot(x,y,'r');
hold on

x=[-1:0.01:1];
y=[1  0.980066  0.960345  0.94085  0.921594  0.902462  0.883558  0.864875  0.846397  0.82811  0.810011  0.792107  0.774401  0.756898  0.739597  0.722498  0.7056  0.688901  0.672401  0.656101  0.64  0.6241  0.6084  0.5929  0.5776  0.5625  0.5476  0.5329  0.5184  0.5041  0.49  0.4761  0.4624  0.4489  0.4356  0.4225  0.4096  0.3969  0.3844  0.3721  0.36  0.3481  0.3364  0.3249  0.3136  0.3025  0.2916  0.2809  0.2704  0.2601  0.25  0.2401  0.2304  0.2209  0.2116  0.2025  0.1936  0.1849  0.1764  0.1681  0.16  0.1521  0.1444  0.1369  0.1296  0.1225  0.1156  0.1089  0.1024  0.0961  0.09  0.0841  0.0784  0.0729  0.0676  0.0625  0.0576  0.0529  0.0484  0.0441  0.04  0.0361  0.0324  0.0289  0.0256  0.0225  0.0196  0.0169  0.0144  0.0121  0.01  0.0081  0.0064  0.0049  0.0036  0.0025  0.0016  0.0009  0.0004  0.0001  6.14116e-18  0.0001  0.0004  0.0009  0.0016  0.0025  0.0036  0.0049  0.0064  0.0081  0.01  0.0121  0.0144  0.0169  0.0196  0.0225  0.0256  0.0289  0.0324  0.0361  0.04  0.0441  0.0484  0.0529  0.0576  0.0625  0.0676  0.0729  0.0784  0.0841  0.09  0.0961  0.1024  0.1089  0.1156  0.1225  0.1296  0.1369  0.1444  0.1521  0.16  0.1681  0.1764  0.1849  0.1936  0.2025  0.2116  0.2209  0.2304  0.2401  0.25  0.2601  0.2704  0.2809  0.2916  0.3025  0.3136  0.3249  0.3364  0.3481  0.36  0.3721  0.3844  0.3969  0.4096  0.4225  0.4356  0.4489  0.4624  0.4761  0.49  0.5041  0.5184  0.5329  0.5476  0.5625  0.5776  0.5929  0.6084  0.6241  0.64  0.656101  0.672401  0.688901  0.7056  0.722498  0.739597  0.756898  0.774401  0.792107  0.810011  0.82811  0.846397  0.864875  0.883558  0.902462  0.921594  0.94085  0.960345  0.980066  1];
plot(x,y,'b');

plot(dot_x,dot_y,'r--');

for i = 1:50
    plot(dot_x(i), dot_y(i), 'r.','MarkerSize', 10);
end

title('F1 Spline Interpolation uniform grid');
legend({'y = x^2', 'Spline', 'y = x^2, grid', 'Uniform grid n = 50'}, 'Location', 'southeast');

%   xlim ([-3.1 3.1]);
%   ylim ([-0.1 1.1]);

grid on;
hold off
