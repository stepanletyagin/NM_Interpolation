% Интерполяция Лагранжем F1 равномерная сетка (n = 3)
dot_x=[-1  0  1];
dot_y=[1  0  1];

x = [-1:0.01:1];
y = x.^2;
plot(x,y,'r');
hold on

x=[-1:0.01:1];
y=[1  0.9801  0.9604  0.9409  0.9216  0.9025  0.8836  0.8649  0.8464  0.8281  0.81  0.7921  0.7744  0.7569  0.7396  0.7225  0.7056  0.6889  0.6724  0.6561  0.64  0.6241  0.6084  0.5929  0.5776  0.5625  0.5476  0.5329  0.5184  0.5041  0.49  0.4761  0.4624  0.4489  0.4356  0.4225  0.4096  0.3969  0.3844  0.3721  0.36  0.3481  0.3364  0.3249  0.3136  0.3025  0.2916  0.2809  0.2704  0.2601  0.25  0.2401  0.2304  0.2209  0.2116  0.2025  0.1936  0.1849  0.1764  0.1681  0.16  0.1521  0.1444  0.1369  0.1296  0.1225  0.1156  0.1089  0.1024  0.0961  0.09  0.0841  0.0784  0.0729  0.0676  0.0625  0.0576  0.0529  0.0484  0.0441  0.04  0.0361  0.0324  0.0289  0.0256  0.0225  0.0196  0.0169  0.0144  0.0121  0.01  0.0081  0.0064  0.0049  0.0036  0.0025  0.0016  0.0009  0.0004  0.0001  0  0.0001  0.0004  0.0009  0.0016  0.0025  0.0036  0.0049  0.0064  0.0081  0.01  0.0121  0.0144  0.0169  0.0196  0.0225  0.0256  0.0289  0.0324  0.0361  0.04  0.0441  0.0484  0.0529  0.0576  0.0625  0.0676  0.0729  0.0784  0.0841  0.09  0.0961  0.1024  0.1089  0.1156  0.1225  0.1296  0.1369  0.1444  0.1521  0.16  0.1681  0.1764  0.1849  0.1936  0.2025  0.2116  0.2209  0.2304  0.2401  0.25  0.2601  0.2704  0.2809  0.2916  0.3025  0.3136  0.3249  0.3364  0.3481  0.36  0.3721  0.3844  0.3969  0.4096  0.4225  0.4356  0.4489  0.4624  0.4761  0.49  0.5041  0.5184  0.5329  0.5476  0.5625  0.5776  0.5929  0.6084  0.6241  0.64  0.6561  0.6724  0.6889  0.7056  0.7225  0.7396  0.7569  0.7744  0.7921  0.81  0.8281  0.8464  0.8649  0.8836  0.9025  0.9216  0.9409  0.9604  0.9801  1];
plot(x,y,'b');

plot(dot_x,dot_y,'r--');

for i = 1:3
    plot(dot_x(i), dot_y(i), 'r.','MarkerSize', 10);
end


title('F1 Lagrange Interpolation uniform grid');
legend({'y = x^2', 'Ln(x)', 'y = x^2, grid', 'Uniform grid n = 3'}, 'Location', 'southeast');

%  xlim ([-1.1 1.1]);
%  ylim ([-0.1 1.1]);

grid on;
hold off

% Интерполяция Лагранжем F1 равномерная сетка (n = 10)
figure;
dot_x = [-1  -0.777778  -0.555556  -0.333333  -0.111111  0.111111  0.333333  0.555556  0.777778  1];
dot_y = [1  0.604938  0.308642  0.111111  0.0123457  0.0123457  0.111111  0.308642  0.604938  1];

x = [-1:0.01:1];
y = x.^2;
plot(x,y,'r');
hold on

x=[-1:0.01:1];
y=[1  0.9801  0.9604  0.9409  0.9216  0.9025  0.8836  0.8649  0.8464  0.8281  0.81  0.7921  0.7744  0.7569  0.7396  0.7225  0.7056  0.6889  0.6724  0.6561  0.64  0.6241  0.6084  0.5929  0.5776  0.5625  0.5476  0.5329  0.5184  0.5041  0.49  0.4761  0.4624  0.4489  0.4356  0.4225  0.4096  0.3969  0.3844  0.3721  0.36  0.3481  0.3364  0.3249  0.3136  0.3025  0.2916  0.2809  0.2704  0.2601  0.25  0.2401  0.2304  0.2209  0.2116  0.2025  0.1936  0.1849  0.1764  0.1681  0.16  0.1521  0.1444  0.1369  0.1296  0.1225  0.1156  0.1089  0.1024  0.0961  0.09  0.0841  0.0784  0.0729  0.0676  0.0625  0.0576  0.0529  0.0484  0.0441  0.04  0.0361  0.0324  0.0289  0.0256  0.0225  0.0196  0.0169  0.0144  0.0121  0.01  0.0081  0.0064  0.0049  0.0036  0.0025  0.0016  0.0009  0.0004  0.0001  -7.26415e-18  0.0001  0.0004  0.0009  0.0016  0.0025  0.0036  0.0049  0.0064  0.0081  0.01  0.0121  0.0144  0.0169  0.0196  0.0225  0.0256  0.0289  0.0324  0.0361  0.04  0.0441  0.0484  0.0529  0.0576  0.0625  0.0676  0.0729  0.0784  0.0841  0.09  0.0961  0.1024  0.1089  0.1156  0.1225  0.1296  0.1369  0.1444  0.1521  0.16  0.1681  0.1764  0.1849  0.1936  0.2025  0.2116  0.2209  0.2304  0.2401  0.25  0.2601  0.2704  0.2809  0.2916  0.3025  0.3136  0.3249  0.3364  0.3481  0.36  0.3721  0.3844  0.3969  0.4096  0.4225  0.4356  0.4489  0.4624  0.4761  0.49  0.5041  0.5184  0.5329  0.5476  0.5625  0.5776  0.5929  0.6084  0.6241  0.64  0.6561  0.6724  0.6889  0.7056  0.7225  0.7396  0.7569  0.7744  0.7921  0.81  0.8281  0.8464  0.8649  0.8836  0.9025  0.9216  0.9409  0.9604  0.9801  1 ];
plot(x,y,'b');

plot(dot_x,dot_y,'r--');

for i = 1:10
    plot(dot_x(i), dot_y(i), 'r.','MarkerSize', 10);
end

title('F1 Lagrange Interpolation uniform grid');
legend({'y = x^2', 'Ln(x)', 'y = x^2, grid', 'Uniform grid n = 10'}, 'Location', 'southeast');

%  xlim ([-1.1 1.1]);
%  ylim ([-0.7 1.1]);

grid on;
hold off

% Интерполяция Лагранжем F1 равномерная сетка (n = 50)
figure;
dot_x=[-1  -0.959184  -0.918367  -0.877551  -0.836735  -0.795918  -0.755102  -0.714286  -0.673469  -0.632653  -0.591837  -0.55102  -0.510204  -0.469388  -0.428571  -0.387755  -0.346939  -0.306122  -0.265306  -0.22449  -0.183673  -0.142857  -0.102041  -0.0612245  -0.0204082  0.0204082  0.0612245  0.102041  0.142857  0.183673  0.22449  0.265306  0.306122  0.346939  0.387755  0.428571  0.469388  0.510204  0.55102  0.591837  0.632653  0.673469  0.714286  0.755102  0.795918  0.836735  0.877551  0.918367  0.959184  1];
dot_y=[1  0.920033  0.843399  0.770096  0.700125  0.633486  0.570179  0.510204  0.453561  0.40025  0.350271  0.303623  0.260308  0.220325  0.183673  0.150354  0.120367  0.093711  0.0703873  0.0503957  0.0337359  0.0204082  0.0104123  0.00374844  0.000416493  0.000416493  0.00374844  0.0104123  0.0204082  0.0337359  0.0503957  0.0703873  0.093711  0.120367  0.150354  0.183673  0.220325  0.260308  0.303623  0.350271  0.40025  0.453561  0.510204  0.570179  0.633486  0.700125  0.770096  0.843399  0.920033  1  ];

x = [-1:0.01:1];
y = x.^2;
plot(x,y,'r');
hold on

x=[-1:0.01:1];
y=[1  0.980094  0.960398  0.9409  0.9216  0.9025  0.8836  0.8649  0.8464  0.8281  0.81  0.7921  0.7744  0.7569  0.7396  0.7225  0.7056  0.6889  0.6724  0.6561  0.64  0.6241  0.6084  0.5929  0.5776  0.5625  0.5476  0.5329  0.5184  0.5041  0.49  0.4761  0.4624  0.4489  0.4356  0.4225  0.4096  0.3969  0.3844  0.3721  0.36  0.3481  0.3364  0.3249  0.3136  0.3025  0.2916  0.2809  0.2704  0.2601  0.25  0.2401  0.2304  0.2209  0.2116  0.2025  0.1936  0.1849  0.1764  0.1681  0.16  0.1521  0.1444  0.1369  0.1296  0.1225  0.1156  0.1089  0.1024  0.0961  0.09  0.0841  0.0784  0.0729  0.0676  0.0625  0.0576  0.0529  0.0484  0.0441  0.04  0.0361  0.0324  0.0289  0.0256  0.0225  0.0196  0.0169  0.0144  0.0121  0.01  0.0081  0.0064  0.0049  0.0036  0.0025  0.0016  0.0009  0.0004  0.0001  2.08295e-18  0.0001  0.0004  0.0009  0.0016  0.0025  0.0036  0.0049  0.0064  0.0081  0.01  0.0121  0.0144  0.0169  0.0196  0.0225  0.0256  0.0289  0.0324  0.0361  0.04  0.0441  0.0484  0.0529  0.0576  0.0625  0.0676  0.0729  0.0784  0.0841  0.09  0.0961  0.1024  0.1089  0.1156  0.1225  0.1296  0.1369  0.1444  0.1521  0.16  0.1681  0.1764  0.1849  0.1936  0.2025  0.2116  0.2209  0.2304  0.2401  0.25  0.2601  0.2704  0.2809  0.2916  0.3025  0.3136  0.3249  0.3364  0.3481  0.36  0.3721  0.3844  0.3969  0.4096  0.4225  0.4356  0.4489  0.4624  0.4761  0.49  0.5041  0.5184  0.5329  0.5476  0.5625  0.5776  0.5929  0.6084  0.6241  0.64  0.6561  0.6724  0.6889  0.7056  0.7225  0.7396  0.7569  0.7744  0.7921  0.81  0.8281  0.8464  0.8649  0.8836  0.9025  0.9216  0.940902  0.960395  0.980099  1];
plot(x,y,'b');

plot(dot_x,dot_y,'r--');

for i = 1:50
    plot(dot_x(i), dot_y(i), 'r.','MarkerSize', 10);
end

title('F1 Lagrange Interpolation uniform grid');
legend({'y = x^2', 'Ln(x)', 'y = x^2, grid', 'Uniform grid n = 50'}, 'Location', 'southeast');

% xlim ([-3.1 3.1]);
% ylim ([-6 2]);

grid on;
hold off
