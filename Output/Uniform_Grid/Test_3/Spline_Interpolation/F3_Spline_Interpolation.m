% Интерполяция сплайнами F3 равномерная сетка (n = 3)
dot_x=[-3  0  3 ];
dot_y=[0.641105  1.27324  0.641105];

x = [-3:0.01:3];
y = 1./(atan(1 + 10.*x.^2));
plot(x,y,'r');
hold on

x=[-3  -2.99  -2.98  -2.97  -2.96  -2.95  -2.94  -2.93  -2.92  -2.91  -2.9  -2.89  -2.88  -2.87  -2.86  -2.85  -2.84  -2.83  -2.82  -2.81  -2.8  -2.79  -2.78  -2.77  -2.76  -2.75  -2.74  -2.73  -2.72  -2.71  -2.7  -2.69  -2.68  -2.67  -2.66  -2.65  -2.64  -2.63  -2.62  -2.61  -2.6  -2.59  -2.58  -2.57  -2.56  -2.55  -2.54  -2.53  -2.52  -2.51  -2.5  -2.49  -2.48  -2.47  -2.46  -2.45  -2.44  -2.43  -2.42  -2.41  -2.4  -2.39  -2.38  -2.37  -2.36  -2.35  -2.34  -2.33  -2.32  -2.31  -2.3  -2.29  -2.28  -2.27  -2.26  -2.25  -2.24  -2.23  -2.22  -2.21  -2.2  -2.19  -2.18  -2.17  -2.16  -2.15  -2.14  -2.13  -2.12  -2.11  -2.1  -2.09  -2.08  -2.07  -2.06  -2.05  -2.04  -2.03  -2.02  -2.01  -2  -1.99  -1.98  -1.97  -1.96  -1.95  -1.94  -1.93  -1.92  -1.91  -1.9  -1.89  -1.88  -1.87  -1.86  -1.85  -1.84  -1.83  -1.82  -1.81  -1.8  -1.79  -1.78  -1.77  -1.76  -1.75  -1.74  -1.73  -1.72  -1.71  -1.7  -1.69  -1.68  -1.67  -1.66  -1.65  -1.64  -1.63  -1.62  -1.61  -1.6  -1.59  -1.58  -1.57  -1.56  -1.55  -1.54  -1.53  -1.52  -1.51  -1.5  -1.49  -1.48  -1.47  -1.46  -1.45  -1.44  -1.43  -1.42  -1.41  -1.4  -1.39  -1.38  -1.37  -1.36  -1.35  -1.34  -1.33  -1.32  -1.31  -1.3  -1.29  -1.28  -1.27  -1.26  -1.25  -1.24  -1.23  -1.22  -1.21  -1.2  -1.19  -1.18  -1.17  -1.16  -1.15  -1.14  -1.13  -1.12  -1.11  -1.1  -1.09  -1.08  -1.07  -1.06  -1.05  -1.04  -1.03  -1.02  -1.01  -1  -0.99  -0.98  -0.97  -0.96  -0.95  -0.94  -0.93  -0.92  -0.91  -0.9  -0.89  -0.88  -0.87  -0.86  -0.85  -0.84  -0.83  -0.82  -0.81  -0.8  -0.79  -0.78  -0.77  -0.76  -0.75  -0.74  -0.73  -0.72  -0.71  -0.7  -0.69  -0.68  -0.67  -0.66  -0.65  -0.64  -0.63  -0.62  -0.61  -0.6  -0.59  -0.58  -0.57  -0.56  -0.55  -0.54  -0.53  -0.52  -0.51  -0.5  -0.49  -0.48  -0.47  -0.46  -0.45  -0.44  -0.43  -0.42  -0.41  -0.4  -0.39  -0.38  -0.37  -0.36  -0.35  -0.34  -0.33  -0.32  -0.31  -0.3  -0.29  -0.28  -0.27  -0.26  -0.25  -0.24  -0.23  -0.22  -0.21  -0.2  -0.19  -0.18  -0.17  -0.16  -0.15  -0.14  -0.13  -0.12  -0.11  -0.1  -0.09  -0.08  -0.07  -0.06  -0.05  -0.04  -0.03  -0.02  -0.01  0  0.01  0.02  0.03  0.04  0.05  0.06  0.07  0.08  0.09  0.1  0.11  0.12  0.13  0.14  0.15  0.16  0.17  0.18  0.19  0.2  0.21  0.22  0.23  0.24  0.25  0.26  0.27  0.28  0.29  0.3  0.31  0.32  0.33  0.34  0.35  0.36  0.37  0.38  0.39  0.4  0.41  0.42  0.43  0.44  0.45  0.46  0.47  0.48  0.49  0.5  0.51  0.52  0.53  0.54  0.55  0.56  0.57  0.58  0.59  0.6  0.61  0.62  0.63  0.64  0.65  0.66  0.67  0.68  0.69  0.7  0.71  0.72  0.73  0.74  0.75  0.76  0.77  0.78  0.79  0.8  0.81  0.82  0.83  0.84  0.85  0.86  0.87  0.88  0.89  0.9  0.91  0.92  0.93  0.94  0.95  0.96  0.97  0.98  0.99  1  1.01  1.02  1.03  1.04  1.05  1.06  1.07  1.08  1.09  1.1  1.11  1.12  1.13  1.14  1.15  1.16  1.17  1.18  1.19  1.2  1.21  1.22  1.23  1.24  1.25  1.26  1.27  1.28  1.29  1.3  1.31  1.32  1.33  1.34  1.35  1.36  1.37  1.38  1.39  1.4  1.41  1.42  1.43  1.44  1.45  1.46  1.47  1.48  1.49  1.5  1.51  1.52  1.53  1.54  1.55  1.56  1.57  1.58  1.59  1.6  1.61  1.62  1.63  1.64  1.65  1.66  1.67  1.68  1.69  1.7  1.71  1.72  1.73  1.74  1.75  1.76  1.77  1.78  1.79  1.8  1.81  1.82  1.83  1.84  1.85  1.86  1.87  1.88  1.89  1.9  1.91  1.92  1.93  1.94  1.95  1.96  1.97  1.98  1.99  2  2.01  2.02  2.03  2.04  2.05  2.06  2.07  2.08  2.09  2.1  2.11  2.12  2.13  2.14  2.15  2.16  2.17  2.18  2.19  2.2  2.21  2.22  2.23  2.24  2.25  2.26  2.27  2.28  2.29  2.3  2.31  2.32  2.33  2.34  2.35  2.36  2.37  2.38  2.39  2.4  2.41  2.42  2.43  2.44  2.45  2.46  2.47  2.48  2.49  2.5  2.51  2.52  2.53  2.54  2.55  2.56  2.57  2.58  2.59  2.6  2.61  2.62  2.63  2.64  2.65  2.66  2.67  2.68  2.69  2.7  2.71  2.72  2.73  2.74  2.75  2.76  2.77  2.78  2.79  2.8  2.81  2.82  2.83  2.84  2.85  2.86  2.87  2.88  2.89  2.9  2.91  2.92  2.93  2.94  2.95  2.96  2.97  2.98  2.99  3];
y=[0.641105  0.644265  0.647426  0.650586  0.653747  0.656907  0.660066  0.663225  0.666384  0.669542  0.6727  0.675856  0.679013  0.682168  0.685322  0.688475  0.691627  0.694779  0.697929  0.701077  0.704224  0.70737  0.710515  0.713658  0.716799  0.719939  0.723076  0.726212  0.729347  0.732479  0.735609  0.738737  0.741863  0.744986  0.748107  0.751226  0.754343  0.757457  0.760568  0.763677  0.766782  0.769885  0.772986  0.776083  0.779177  0.782268  0.785356  0.788441  0.791522  0.7946  0.797675  0.800746  0.803814  0.806878  0.809938  0.812994  0.816047  0.819095  0.82214  0.82518  0.828217  0.831249  0.834277  0.8373  0.840319  0.843334  0.846344  0.849349  0.85235  0.855346  0.858337  0.861323  0.864304  0.86728  0.870251  0.873217  0.876177  0.879132  0.882082  0.885026  0.887965  0.890898  0.893826  0.896747  0.899663  0.902573  0.905477  0.908375  0.911267  0.914152  0.917032  0.919905  0.922771  0.925631  0.928485  0.931332  0.934172  0.937006  0.939833  0.942653  0.945466  0.948272  0.951071  0.953862  0.956647  0.959424  0.962194  0.964956  0.967711  0.970458  0.973198  0.97593  0.978654  0.98137  0.984078  0.986779  0.989471  0.992155  0.994831  0.997498  1.00016  1.00281  1.00545  1.00808  1.01071  1.01333  1.01593  1.01853  1.02112  1.0237  1.02627  1.02884  1.03139  1.03393  1.03647  1.03899  1.04151  1.04402  1.04651  1.049  1.05148  1.05394  1.0564  1.05885  1.06129  1.06371  1.06613  1.06854  1.07094  1.07332  1.0757  1.07806  1.08042  1.08276  1.08509  1.08742  1.08973  1.09203  1.09432  1.0966  1.09886  1.10112  1.10336  1.1056  1.10782  1.11003  1.11223  1.11442  1.11659  1.11876  1.12091  1.12305  1.12517  1.12729  1.12939  1.13148  1.13356  1.13563  1.13768  1.13973  1.14176  1.14377  1.14578  1.14777  1.14974  1.15171  1.15366  1.1556  1.15753  1.15944  1.16134  1.16323  1.1651  1.16696  1.1688  1.17064  1.17245  1.17426  1.17605  1.17783  1.17959  1.18134  1.18307  1.18479  1.1865  1.18819  1.18987  1.19153  1.19318  1.19482  1.19644  1.19804  1.19963  1.2012  1.20276  1.20431  1.20584  1.20735  1.20885  1.21034  1.21181  1.21326  1.2147  1.21612  1.21752  1.21892  1.22029  1.22165  1.22299  1.22432  1.22563  1.22693  1.2282  1.22947  1.23071  1.23194  1.23315  1.23435  1.23553  1.23669  1.23784  1.23897  1.24008  1.24118  1.24226  1.24332  1.24436  1.24539  1.2464  1.24739  1.24836  1.24932  1.25026  1.25118  1.25209  1.25297  1.25384  1.25469  1.25552  1.25634  1.25713  1.25791  1.25867  1.25941  1.26013  1.26084  1.26152  1.26219  1.26283  1.26346  1.26407  1.26466  1.26524  1.26579  1.26632  1.26684  1.26733  1.26781  1.26826  1.2687  1.26912  1.26952  1.26989  1.27025  1.27059  1.27091  1.27121  1.27148  1.27174  1.27198  1.2722  1.27239  1.27257  1.27273  1.27286  1.27298  1.27307  1.27315  1.2732  1.27323  1.27324  1.27323  1.2732  1.27315  1.27307  1.27298  1.27286  1.27273  1.27257  1.27239  1.2722  1.27198  1.27174  1.27148  1.27121  1.27091  1.27059  1.27025  1.26989  1.26952  1.26912  1.2687  1.26826  1.26781  1.26733  1.26684  1.26632  1.26579  1.26524  1.26466  1.26407  1.26346  1.26283  1.26219  1.26152  1.26084  1.26013  1.25941  1.25867  1.25791  1.25713  1.25634  1.25552  1.25469  1.25384  1.25297  1.25209  1.25118  1.25026  1.24932  1.24836  1.24739  1.2464  1.24539  1.24436  1.24332  1.24226  1.24118  1.24008  1.23897  1.23784  1.23669  1.23553  1.23435  1.23315  1.23194  1.23071  1.22947  1.2282  1.22693  1.22563  1.22432  1.22299  1.22165  1.22029  1.21892  1.21752  1.21612  1.2147  1.21326  1.21181  1.21034  1.20885  1.20735  1.20584  1.20431  1.20276  1.2012  1.19963  1.19804  1.19644  1.19482  1.19318  1.19153  1.18987  1.18819  1.1865  1.18479  1.18307  1.18134  1.17959  1.17783  1.17605  1.17426  1.17245  1.17064  1.1688  1.16696  1.1651  1.16323  1.16134  1.15944  1.15753  1.1556  1.15366  1.15171  1.14974  1.14777  1.14578  1.14377  1.14176  1.13973  1.13768  1.13563  1.13356  1.13148  1.12939  1.12729  1.12517  1.12305  1.12091  1.11876  1.11659  1.11442  1.11223  1.11003  1.10782  1.1056  1.10336  1.10112  1.09886  1.0966  1.09432  1.09203  1.08973  1.08742  1.08509  1.08276  1.08042  1.07806  1.0757  1.07332  1.07094  1.06854  1.06613  1.06371  1.06129  1.05885  1.0564  1.05394  1.05148  1.049  1.04651  1.04402  1.04151  1.03899  1.03647  1.03393  1.03139  1.02884  1.02627  1.0237  1.02112  1.01853  1.01593  1.01333  1.01071  1.00808  1.00545  1.00281  1.00016  0.997498  0.994831  0.992155  0.989471  0.986779  0.984078  0.98137  0.978654  0.97593  0.973198  0.970458  0.967711  0.964956  0.962194  0.959424  0.956647  0.953862  0.951071  0.948272  0.945466  0.942653  0.939833  0.937006  0.934172  0.931332  0.928485  0.925631  0.922771  0.919905  0.917032  0.914152  0.911267  0.908375  0.905477  0.902573  0.899663  0.896747  0.893826  0.890898  0.887965  0.885026  0.882082  0.879132  0.876177  0.873217  0.870251  0.86728  0.864304  0.861323  0.858337  0.855346  0.85235  0.849349  0.846344  0.843334  0.840319  0.8373  0.834277  0.831249  0.828217  0.82518  0.82214  0.819095  0.816047  0.812994  0.809938  0.806878  0.803814  0.800746  0.797675  0.7946  0.791522  0.788441  0.785356  0.782268  0.779177  0.776083  0.772986  0.769885  0.766782  0.763677  0.760568  0.757457  0.754343  0.751226  0.748107  0.744986  0.741863  0.738737  0.735609  0.732479  0.729347  0.726212  0.723076  0.719939  0.716799  0.713658  0.710515  0.70737  0.704224  0.701077  0.697929  0.694779  0.691627  0.688475  0.685322  0.682168  0.679013  0.675856  0.6727  0.669542  0.666384  0.663225  0.660066  0.656907  0.653747  0.650586  0.647426  0.644265  0.641105];
plot(x,y,'b');

plot(dot_x,dot_y,'r--');

for i = 1:3
    plot(dot_x(i), dot_y(i), 'r.','MarkerSize', 10);
end


title('F3 Spline Interpolation uniform grid');
legend({'y = 1/(arctg(1 + 10x^2))', 'Spline', 'y = 1/(arctg(1 + 10x^2)), grid', 'Uniform grid n = 3'}, 'Location', 'southeast');

xlim ([-3.1 3.1]);
ylim ([0.6 1.3]);

grid on;
hold off

% Интерполяция сплайнами F3 равномерная сетка (n = 10)
figure;
dot_x = [-3  -2.33333  -1.66667  -1  -0.333333  0.333333  1  1.66667  2.33333  3 ];
dot_y = [0.641105  0.644014  0.651016  0.675613  0.886193  0.886193  0.675613  0.651016  0.644014  0.641105];

x = [-3:0.01:3];
y = 1./(atan(1 + 10.*x.^2));
plot(x,y,'r');
hold on

x=[-3  -2.99  -2.98  -2.97  -2.96  -2.95  -2.94  -2.93  -2.92  -2.91  -2.9  -2.89  -2.88  -2.87  -2.86  -2.85  -2.84  -2.83  -2.82  -2.81  -2.8  -2.79  -2.78  -2.77  -2.76  -2.75  -2.74  -2.73  -2.72  -2.71  -2.7  -2.69  -2.68  -2.67  -2.66  -2.65  -2.64  -2.63  -2.62  -2.61  -2.6  -2.59  -2.58  -2.57  -2.56  -2.55  -2.54  -2.53  -2.52  -2.51  -2.5  -2.49  -2.48  -2.47  -2.46  -2.45  -2.44  -2.43  -2.42  -2.41  -2.4  -2.39  -2.38  -2.37  -2.36  -2.35  -2.34  -2.33  -2.32  -2.31  -2.3  -2.29  -2.28  -2.27  -2.26  -2.25  -2.24  -2.23  -2.22  -2.21  -2.2  -2.19  -2.18  -2.17  -2.16  -2.15  -2.14  -2.13  -2.12  -2.11  -2.1  -2.09  -2.08  -2.07  -2.06  -2.05  -2.04  -2.03  -2.02  -2.01  -2  -1.99  -1.98  -1.97  -1.96  -1.95  -1.94  -1.93  -1.92  -1.91  -1.9  -1.89  -1.88  -1.87  -1.86  -1.85  -1.84  -1.83  -1.82  -1.81  -1.8  -1.79  -1.78  -1.77  -1.76  -1.75  -1.74  -1.73  -1.72  -1.71  -1.7  -1.69  -1.68  -1.67  -1.66  -1.65  -1.64  -1.63  -1.62  -1.61  -1.6  -1.59  -1.58  -1.57  -1.56  -1.55  -1.54  -1.53  -1.52  -1.51  -1.5  -1.49  -1.48  -1.47  -1.46  -1.45  -1.44  -1.43  -1.42  -1.41  -1.4  -1.39  -1.38  -1.37  -1.36  -1.35  -1.34  -1.33  -1.32  -1.31  -1.3  -1.29  -1.28  -1.27  -1.26  -1.25  -1.24  -1.23  -1.22  -1.21  -1.2  -1.19  -1.18  -1.17  -1.16  -1.15  -1.14  -1.13  -1.12  -1.11  -1.1  -1.09  -1.08  -1.07  -1.06  -1.05  -1.04  -1.03  -1.02  -1.01  -1  -0.99  -0.98  -0.97  -0.96  -0.95  -0.94  -0.93  -0.92  -0.91  -0.9  -0.89  -0.88  -0.87  -0.86  -0.85  -0.84  -0.83  -0.82  -0.81  -0.8  -0.79  -0.78  -0.77  -0.76  -0.75  -0.74  -0.73  -0.72  -0.71  -0.7  -0.69  -0.68  -0.67  -0.66  -0.65  -0.64  -0.63  -0.62  -0.61  -0.6  -0.59  -0.58  -0.57  -0.56  -0.55  -0.54  -0.53  -0.52  -0.51  -0.5  -0.49  -0.48  -0.47  -0.46  -0.45  -0.44  -0.43  -0.42  -0.41  -0.4  -0.39  -0.38  -0.37  -0.36  -0.35  -0.34  -0.33  -0.32  -0.31  -0.3  -0.29  -0.28  -0.27  -0.26  -0.25  -0.24  -0.23  -0.22  -0.21  -0.2  -0.19  -0.18  -0.17  -0.16  -0.15  -0.14  -0.13  -0.12  -0.11  -0.1  -0.09  -0.08  -0.07  -0.06  -0.05  -0.04  -0.03  -0.02  -0.01  0  0.01  0.02  0.03  0.04  0.05  0.06  0.07  0.08  0.09  0.1  0.11  0.12  0.13  0.14  0.15  0.16  0.17  0.18  0.19  0.2  0.21  0.22  0.23  0.24  0.25  0.26  0.27  0.28  0.29  0.3  0.31  0.32  0.33  0.34  0.35  0.36  0.37  0.38  0.39  0.4  0.41  0.42  0.43  0.44  0.45  0.46  0.47  0.48  0.49  0.5  0.51  0.52  0.53  0.54  0.55  0.56  0.57  0.58  0.59  0.6  0.61  0.62  0.63  0.64  0.65  0.66  0.67  0.68  0.69  0.7  0.71  0.72  0.73  0.74  0.75  0.76  0.77  0.78  0.79  0.8  0.81  0.82  0.83  0.84  0.85  0.86  0.87  0.88  0.89  0.9  0.91  0.92  0.93  0.94  0.95  0.96  0.97  0.98  0.99  1  1.01  1.02  1.03  1.04  1.05  1.06  1.07  1.08  1.09  1.1  1.11  1.12  1.13  1.14  1.15  1.16  1.17  1.18  1.19  1.2  1.21  1.22  1.23  1.24  1.25  1.26  1.27  1.28  1.29  1.3  1.31  1.32  1.33  1.34  1.35  1.36  1.37  1.38  1.39  1.4  1.41  1.42  1.43  1.44  1.45  1.46  1.47  1.48  1.49  1.5  1.51  1.52  1.53  1.54  1.55  1.56  1.57  1.58  1.59  1.6  1.61  1.62  1.63  1.64  1.65  1.66  1.67  1.68  1.69  1.7  1.71  1.72  1.73  1.74  1.75  1.76  1.77  1.78  1.79  1.8  1.81  1.82  1.83  1.84  1.85  1.86  1.87  1.88  1.89  1.9  1.91  1.92  1.93  1.94  1.95  1.96  1.97  1.98  1.99  2  2.01  2.02  2.03  2.04  2.05  2.06  2.07  2.08  2.09  2.1  2.11  2.12  2.13  2.14  2.15  2.16  2.17  2.18  2.19  2.2  2.21  2.22  2.23  2.24  2.25  2.26  2.27  2.28  2.29  2.3  2.31  2.32  2.33  2.34  2.35  2.36  2.37  2.38  2.39  2.4  2.41  2.42  2.43  2.44  2.45  2.46  2.47  2.48  2.49  2.5  2.51  2.52  2.53  2.54  2.55  2.56  2.57  2.58  2.59  2.6  2.61  2.62  2.63  2.64  2.65  2.66  2.67  2.68  2.69  2.7  2.71  2.72  2.73  2.74  2.75  2.76  2.77  2.78  2.79  2.8  2.81  2.82  2.83  2.84  2.85  2.86  2.87  2.88  2.89  2.9  2.91  2.92  2.93  2.94  2.95  2.96  2.97  2.98  2.99  3];
y=[0.641105  0.641086  0.641068  0.64105  0.641032  0.641014  0.640997  0.64098  0.640964  0.640949  0.640934  0.64092  0.640907  0.640896  0.640885  0.640875  0.640867  0.64086  0.640854  0.64085  0.640847  0.640847  0.640848  0.64085  0.640855  0.640862  0.640871  0.640881  0.640895  0.64091  0.640928  0.640949  0.640972  0.640998  0.641026  0.641058  0.641092  0.64113  0.64117  0.641214  0.641261  0.641311  0.641365  0.641422  0.641483  0.641547  0.641616  0.641688  0.641764  0.641844  0.641928  0.642017  0.642109  0.642207  0.642308  0.642414  0.642525  0.64264  0.64276  0.642885  0.643015  0.64315  0.64329  0.643435  0.643586  0.643742  0.643903  0.64407  0.644242  0.64442  0.644602  0.644789  0.64498  0.645174  0.645372  0.645574  0.645778  0.645984  0.646193  0.646403  0.646615  0.646828  0.647041  0.647255  0.64747  0.647684  0.647897  0.64811  0.648321  0.64853  0.648738  0.648944  0.649147  0.649346  0.649543  0.649736  0.649925  0.65011  0.650291  0.650466  0.650636  0.6508  0.650959  0.651111  0.651257  0.651395  0.651526  0.65165  0.651766  0.651873  0.651972  0.652062  0.652142  0.652213  0.652274  0.652324  0.652364  0.652393  0.65241  0.652416  0.65241  0.652391  0.65236  0.652316  0.652258  0.652187  0.652102  0.652002  0.651888  0.651758  0.651613  0.651453  0.651277  0.651084  0.650874  0.650649  0.650409  0.650157  0.649894  0.649621  0.649339  0.649051  0.648758  0.648462  0.648164  0.647865  0.647567  0.647272  0.646981  0.646695  0.646417  0.646148  0.645889  0.645641  0.645407  0.645188  0.644985  0.644801  0.644636  0.644491  0.64437  0.644272  0.6442  0.644155  0.644139  0.644153  0.644199  0.644279  0.644393  0.644543  0.644731  0.644959  0.645228  0.645539  0.645894  0.646295  0.646743  0.647239  0.647786  0.648385  0.649036  0.649743  0.650505  0.651326  0.652206  0.653147  0.65415  0.655218  0.65635  0.65755  0.658819  0.660157  0.661568  0.663051  0.664609  0.666244  0.667956  0.669747  0.67162  0.673575  0.675613  0.677737  0.679944  0.682231  0.684596  0.687038  0.689553  0.692139  0.694794  0.697515  0.7003  0.703147  0.706052  0.709015  0.712032  0.715101  0.718219  0.721385  0.724596  0.727848  0.731141  0.734472  0.737838  0.741237  0.744666  0.748123  0.751606  0.755112  0.758639  0.762185  0.765747  0.769322  0.772909  0.776505  0.780107  0.783714  0.787322  0.79093  0.794534  0.798134  0.801725  0.805306  0.808875  0.812429  0.815965  0.819482  0.822976  0.826446  0.829889  0.833303  0.836685  0.840033  0.843344  0.846617  0.849848  0.853035  0.856177  0.85927  0.862312  0.865301  0.868235  0.87111  0.873925  0.876678  0.879365  0.881984  0.884534  0.887011  0.889414  0.891743  0.893999  0.89618  0.898288  0.900322  0.902281  0.904167  0.905979  0.907716  0.90938  0.91097  0.912486  0.913928  0.915296  0.91659  0.917811  0.918957  0.920029  0.921027  0.921952  0.922802  0.923579  0.924281  0.92491  0.925464  0.925945  0.926352  0.926684  0.926943  0.927128  0.927239  0.927276  0.927239  0.927128  0.926943  0.926684  0.926352  0.925945  0.925464  0.92491  0.924281  0.923579  0.922802  0.921952  0.921027  0.920029  0.918957  0.917811  0.91659  0.915296  0.913928  0.912486  0.91097  0.90938  0.907716  0.905979  0.904167  0.902281  0.900322  0.898288  0.89618  0.893999  0.891743  0.889414  0.887011  0.884534  0.881984  0.879365  0.876678  0.873925  0.87111  0.868235  0.865301  0.862312  0.85927  0.856177  0.853035  0.849848  0.846617  0.843344  0.840033  0.836685  0.833303  0.829889  0.826446  0.822976  0.819482  0.815965  0.812429  0.808875  0.805306  0.801725  0.798134  0.794534  0.79093  0.787322  0.783714  0.780107  0.776505  0.772909  0.769322  0.765747  0.762185  0.758639  0.755112  0.751606  0.748123  0.744666  0.741237  0.737838  0.734472  0.731141  0.727848  0.724596  0.721385  0.718219  0.715101  0.712032  0.709015  0.706052  0.703147  0.7003  0.697515  0.694794  0.692139  0.689553  0.687038  0.684596  0.682231  0.679944  0.677737  0.675613  0.673575  0.67162  0.669747  0.667956  0.666244  0.664609  0.663051  0.661568  0.660157  0.658819  0.65755  0.65635  0.655218  0.65415  0.653147  0.652206  0.651326  0.650505  0.649743  0.649036  0.648385  0.647786  0.647239  0.646743  0.646295  0.645894  0.645539  0.645228  0.644959  0.644731  0.644543  0.644393  0.644279  0.644199  0.644153  0.644139  0.644155  0.6442  0.644272  0.64437  0.644491  0.644636  0.644801  0.644985  0.645188  0.645407  0.645641  0.645889  0.646148  0.646417  0.646695  0.646981  0.647272  0.647567  0.647865  0.648164  0.648462  0.648758  0.649051  0.649339  0.649621  0.649894  0.650157  0.650409  0.650649  0.650874  0.651084  0.651277  0.651453  0.651613  0.651758  0.651888  0.652002  0.652102  0.652187  0.652258  0.652316  0.65236  0.652391  0.65241  0.652416  0.65241  0.652393  0.652364  0.652324  0.652274  0.652213  0.652142  0.652062  0.651972  0.651873  0.651766  0.65165  0.651526  0.651395  0.651257  0.651111  0.650959  0.6508  0.650636  0.650466  0.650291  0.65011  0.649925  0.649736  0.649543  0.649346  0.649147  0.648944  0.648738  0.64853  0.648321  0.64811  0.647897  0.647684  0.64747  0.647255  0.647041  0.646828  0.646615  0.646403  0.646193  0.645984  0.645778  0.645574  0.645372  0.645174  0.64498  0.644789  0.644602  0.64442  0.644242  0.64407  0.643903  0.643742  0.643586  0.643435  0.64329  0.64315  0.643015  0.642885  0.64276  0.64264  0.642525  0.642414  0.642308  0.642207  0.642109  0.642017  0.641928  0.641844  0.641764  0.641688  0.641616  0.641547  0.641483  0.641422  0.641365  0.641311  0.641261  0.641214  0.64117  0.64113  0.641092  0.641058  0.641026  0.640998  0.640972  0.640949  0.640928  0.64091  0.640895  0.640881  0.640871  0.640862  0.640855  0.64085  0.640848  0.640847  0.640847  0.64085  0.640854  0.64086  0.640867  0.640875  0.640885  0.640896  0.640907  0.64092  0.640934  0.640949  0.640964  0.64098  0.640997  0.641014  0.641032  0.64105  0.641068  0.641086  0.641105];
plot(x,y,'b');

plot(dot_x,dot_y,'r--');

for i = 1:10
    plot(dot_x(i), dot_y(i), 'r.','MarkerSize', 10);
end

title('F3 Spline Interpolation uniform grid');
legend({'y = 1/(arctg(1 + 10x^2))', 'Spline', 'y = 1/(arctg(1 + 10x^2)), grid', 'Uniform grid n = 10'}, 'Location', 'southeast');

%  xlim ([-1.1 1.1]);
%  ylim ([-0.1 1.1]);

grid on;
hold off

% Интерполяция сплайнами F3 равномерная сетка (n = 50)
figure;
dot_x=[-3  -2.87755  -2.7551  -2.63265  -2.5102  -2.38776  -2.26531  -2.14286  -2.02041  -1.89796  -1.77551  -1.65306  -1.53061  -1.40816  -1.28571  -1.16327  -1.04082  -0.918367  -0.795918  -0.673469  -0.55102  -0.428571  -0.306122  -0.183673  -0.0612245  0.0612245  0.183673  0.306122  0.428571  0.55102  0.673469  0.795918  0.918367  1.04082  1.16327  1.28571  1.40816  1.53061  1.65306  1.77551  1.89796  2.02041  2.14286  2.26531  2.38776  2.5102  2.63265  2.7551  2.87755  3 ];
dot_y=[0.641105  0.641493  0.641933  0.642436  0.643014  0.643683  0.644461  0.645375  0.646459  0.647756  0.649325  0.65125  0.653645  0.656675  0.660583  0.665739  0.672727  0.682505  0.69672  0.718352  0.753051  0.811767  0.913871  1.07673  1.2441  1.2441  1.07673  0.913871  0.811767  0.753051  0.718352  0.69672  0.682505  0.672727  0.665739  0.660583  0.656675  0.653645  0.65125  0.649325  0.647756  0.646459  0.645375  0.644461  0.643683  0.643014  0.642436  0.641933  0.641493  0.641105];

x = [-3:0.01:3];
y = 1./(atan(1 + 10.*x.^2));
plot(x,y,'r');
hold on

x=[-3  -2.99  -2.98  -2.97  -2.96  -2.95  -2.94  -2.93  -2.92  -2.91  -2.9  -2.89  -2.88  -2.87  -2.86  -2.85  -2.84  -2.83  -2.82  -2.81  -2.8  -2.79  -2.78  -2.77  -2.76  -2.75  -2.74  -2.73  -2.72  -2.71  -2.7  -2.69  -2.68  -2.67  -2.66  -2.65  -2.64  -2.63  -2.62  -2.61  -2.6  -2.59  -2.58  -2.57  -2.56  -2.55  -2.54  -2.53  -2.52  -2.51  -2.5  -2.49  -2.48  -2.47  -2.46  -2.45  -2.44  -2.43  -2.42  -2.41  -2.4  -2.39  -2.38  -2.37  -2.36  -2.35  -2.34  -2.33  -2.32  -2.31  -2.3  -2.29  -2.28  -2.27  -2.26  -2.25  -2.24  -2.23  -2.22  -2.21  -2.2  -2.19  -2.18  -2.17  -2.16  -2.15  -2.14  -2.13  -2.12  -2.11  -2.1  -2.09  -2.08  -2.07  -2.06  -2.05  -2.04  -2.03  -2.02  -2.01  -2  -1.99  -1.98  -1.97  -1.96  -1.95  -1.94  -1.93  -1.92  -1.91  -1.9  -1.89  -1.88  -1.87  -1.86  -1.85  -1.84  -1.83  -1.82  -1.81  -1.8  -1.79  -1.78  -1.77  -1.76  -1.75  -1.74  -1.73  -1.72  -1.71  -1.7  -1.69  -1.68  -1.67  -1.66  -1.65  -1.64  -1.63  -1.62  -1.61  -1.6  -1.59  -1.58  -1.57  -1.56  -1.55  -1.54  -1.53  -1.52  -1.51  -1.5  -1.49  -1.48  -1.47  -1.46  -1.45  -1.44  -1.43  -1.42  -1.41  -1.4  -1.39  -1.38  -1.37  -1.36  -1.35  -1.34  -1.33  -1.32  -1.31  -1.3  -1.29  -1.28  -1.27  -1.26  -1.25  -1.24  -1.23  -1.22  -1.21  -1.2  -1.19  -1.18  -1.17  -1.16  -1.15  -1.14  -1.13  -1.12  -1.11  -1.1  -1.09  -1.08  -1.07  -1.06  -1.05  -1.04  -1.03  -1.02  -1.01  -1  -0.99  -0.98  -0.97  -0.96  -0.95  -0.94  -0.93  -0.92  -0.91  -0.9  -0.89  -0.88  -0.87  -0.86  -0.85  -0.84  -0.83  -0.82  -0.81  -0.8  -0.79  -0.78  -0.77  -0.76  -0.75  -0.74  -0.73  -0.72  -0.71  -0.7  -0.69  -0.68  -0.67  -0.66  -0.65  -0.64  -0.63  -0.62  -0.61  -0.6  -0.59  -0.58  -0.57  -0.56  -0.55  -0.54  -0.53  -0.52  -0.51  -0.5  -0.49  -0.48  -0.47  -0.46  -0.45  -0.44  -0.43  -0.42  -0.41  -0.4  -0.39  -0.38  -0.37  -0.36  -0.35  -0.34  -0.33  -0.32  -0.31  -0.3  -0.29  -0.28  -0.27  -0.26  -0.25  -0.24  -0.23  -0.22  -0.21  -0.2  -0.19  -0.18  -0.17  -0.16  -0.15  -0.14  -0.13  -0.12  -0.11  -0.1  -0.09  -0.08  -0.07  -0.06  -0.05  -0.04  -0.03  -0.02  -0.01  0  0.01  0.02  0.03  0.04  0.05  0.06  0.07  0.08  0.09  0.1  0.11  0.12  0.13  0.14  0.15  0.16  0.17  0.18  0.19  0.2  0.21  0.22  0.23  0.24  0.25  0.26  0.27  0.28  0.29  0.3  0.31  0.32  0.33  0.34  0.35  0.36  0.37  0.38  0.39  0.4  0.41  0.42  0.43  0.44  0.45  0.46  0.47  0.48  0.49  0.5  0.51  0.52  0.53  0.54  0.55  0.56  0.57  0.58  0.59  0.6  0.61  0.62  0.63  0.64  0.65  0.66  0.67  0.68  0.69  0.7  0.71  0.72  0.73  0.74  0.75  0.76  0.77  0.78  0.79  0.8  0.81  0.82  0.83  0.84  0.85  0.86  0.87  0.88  0.89  0.9  0.91  0.92  0.93  0.94  0.95  0.96  0.97  0.98  0.99  1  1.01  1.02  1.03  1.04  1.05  1.06  1.07  1.08  1.09  1.1  1.11  1.12  1.13  1.14  1.15  1.16  1.17  1.18  1.19  1.2  1.21  1.22  1.23  1.24  1.25  1.26  1.27  1.28  1.29  1.3  1.31  1.32  1.33  1.34  1.35  1.36  1.37  1.38  1.39  1.4  1.41  1.42  1.43  1.44  1.45  1.46  1.47  1.48  1.49  1.5  1.51  1.52  1.53  1.54  1.55  1.56  1.57  1.58  1.59  1.6  1.61  1.62  1.63  1.64  1.65  1.66  1.67  1.68  1.69  1.7  1.71  1.72  1.73  1.74  1.75  1.76  1.77  1.78  1.79  1.8  1.81  1.82  1.83  1.84  1.85  1.86  1.87  1.88  1.89  1.9  1.91  1.92  1.93  1.94  1.95  1.96  1.97  1.98  1.99  2  2.01  2.02  2.03  2.04  2.05  2.06  2.07  2.08  2.09  2.1  2.11  2.12  2.13  2.14  2.15  2.16  2.17  2.18  2.19  2.2  2.21  2.22  2.23  2.24  2.25  2.26  2.27  2.28  2.29  2.3  2.31  2.32  2.33  2.34  2.35  2.36  2.37  2.38  2.39  2.4  2.41  2.42  2.43  2.44  2.45  2.46  2.47  2.48  2.49  2.5  2.51  2.52  2.53  2.54  2.55  2.56  2.57  2.58  2.59  2.6  2.61  2.62  2.63  2.64  2.65  2.66  2.67  2.68  2.69  2.7  2.71  2.72  2.73  2.74  2.75  2.76  2.77  2.78  2.79  2.8  2.81  2.82  2.83  2.84  2.85  2.86  2.87  2.88  2.89  2.9  2.91  2.92  2.93  2.94  2.95  2.96  2.97  2.98  2.99  3];
y=[0.641105  0.641135  0.641166  0.641197  0.641228  0.641259  0.641291  0.641322  0.641354  0.641386  0.641419  0.641451  0.641485  0.641518  0.641552  0.641586  0.641621  0.641657  0.641692  0.641728  0.641765  0.641802  0.641839  0.641876  0.641915  0.641953  0.641992  0.642031  0.642071  0.642111  0.642151  0.642192  0.642234  0.642276  0.642318  0.642361  0.642404  0.642448  0.642492  0.642537  0.642583  0.642628  0.642675  0.642722  0.642769  0.642817  0.642866  0.642915  0.642965  0.643015  0.643066  0.643118  0.64317  0.643223  0.643276  0.64333  0.643385  0.643441  0.643497  0.643554  0.643611  0.643669  0.643728  0.643788  0.643849  0.64391  0.643972  0.644035  0.644098  0.644163  0.644228  0.644294  0.644361  0.644429  0.644498  0.644567  0.644638  0.644709  0.644782  0.644855  0.64493  0.645005  0.645082  0.645159  0.645238  0.645318  0.645399  0.64548  0.645564  0.645648  0.645733  0.64582  0.645908  0.645997  0.646087  0.646179  0.646272  0.646367  0.646463  0.64656  0.646659  0.646759  0.64686  0.646964  0.647068  0.647175  0.647283  0.647393  0.647504  0.647617  0.647732  0.647849  0.647967  0.648087  0.64821  0.648334  0.64846  0.648588  0.648719  0.648851  0.648986  0.649123  0.649262  0.649404  0.649548  0.649694  0.649843  0.649994  0.650148  0.650305  0.650464  0.650626  0.650791  0.650959  0.65113  0.651304  0.651481  0.651661  0.651845  0.652032  0.652222  0.652416  0.652613  0.652815  0.65302  0.653229  0.653442  0.653659  0.65388  0.654105  0.654335  0.654569  0.654808  0.655052  0.655301  0.655555  0.655814  0.656078  0.656348  0.656624  0.656905  0.657192  0.657485  0.657784  0.65809  0.658402  0.658721  0.659048  0.659381  0.659722  0.660071  0.660427  0.660792  0.661165  0.661546  0.661936  0.662336  0.662745  0.663163  0.663592  0.664031  0.664481  0.664942  0.665414  0.665898  0.666394  0.666902  0.667424  0.667959  0.668507  0.669071  0.669649  0.670242  0.670852  0.671478  0.672121  0.672782  0.67346  0.674157  0.674874  0.675612  0.67637  0.677151  0.677955  0.678783  0.679636  0.680514  0.681418  0.68235  0.68331  0.684299  0.68532  0.686373  0.68746  0.688582  0.689742  0.69094  0.692178  0.693458  0.694781  0.696149  0.697563  0.699025  0.700538  0.702106  0.703731  0.705415  0.707162  0.708974  0.710855  0.712807  0.714833  0.716936  0.719118  0.721384  0.72374  0.726189  0.728739  0.731395  0.734163  0.737047  0.740054  0.743189  0.746458  0.749867  0.753421  0.757126  0.760993  0.765032  0.769254  0.773669  0.778289  0.783123  0.788181  0.793476  0.799017  0.804814  0.810879  0.817222  0.823857  0.830801  0.838068  0.845674  0.853635  0.861966  0.870682  0.879799  0.889332  0.899297  0.90971  0.920583  0.931916  0.943692  0.955896  0.968513  0.981525  0.994918  1.00868  1.02278  1.03723  1.05199  1.06705  1.0824  1.09796  1.11362  1.12924  1.14467  1.15978  1.17443  1.18849  1.20183  1.21429  1.22576  1.23608  1.24514  1.25281  1.25909  1.26397  1.26745  1.26955  1.27024  1.26955  1.26745  1.26397  1.25909  1.25281  1.24514  1.23608  1.22576  1.21429  1.20183  1.18849  1.17443  1.15978  1.14467  1.12924  1.11362  1.09796  1.0824  1.06705  1.05199  1.03723  1.02278  1.00868  0.994918  0.981525  0.968513  0.955896  0.943692  0.931916  0.920583  0.90971  0.899297  0.889332  0.879799  0.870682  0.861966  0.853635  0.845674  0.838068  0.830801  0.823857  0.817222  0.810879  0.804814  0.799017  0.793476  0.788181  0.783123  0.778289  0.773669  0.769254  0.765032  0.760993  0.757126  0.753421  0.749867  0.746458  0.743189  0.740054  0.737047  0.734163  0.731395  0.728739  0.726189  0.72374  0.721384  0.719118  0.716936  0.714833  0.712807  0.710855  0.708974  0.707162  0.705415  0.703731  0.702106  0.700538  0.699025  0.697563  0.696149  0.694781  0.693458  0.692178  0.69094  0.689742  0.688582  0.68746  0.686373  0.68532  0.684299  0.68331  0.68235  0.681418  0.680514  0.679636  0.678783  0.677955  0.677151  0.67637  0.675612  0.674874  0.674157  0.67346  0.672782  0.672121  0.671478  0.670852  0.670242  0.669649  0.669071  0.668507  0.667959  0.667424  0.666902  0.666394  0.665898  0.665414  0.664942  0.664481  0.664031  0.663592  0.663163  0.662745  0.662336  0.661936  0.661546  0.661165  0.660792  0.660427  0.660071  0.659722  0.659381  0.659048  0.658721  0.658402  0.65809  0.657784  0.657485  0.657192  0.656905  0.656624  0.656348  0.656078  0.655814  0.655555  0.655301  0.655052  0.654808  0.654569  0.654335  0.654105  0.65388  0.653659  0.653442  0.653229  0.65302  0.652815  0.652613  0.652416  0.652222  0.652032  0.651845  0.651661  0.651481  0.651304  0.65113  0.650959  0.650791  0.650626  0.650464  0.650305  0.650148  0.649994  0.649843  0.649694  0.649548  0.649404  0.649262  0.649123  0.648986  0.648851  0.648719  0.648588  0.64846  0.648334  0.64821  0.648087  0.647967  0.647849  0.647732  0.647617  0.647504  0.647393  0.647283  0.647175  0.647068  0.646964  0.64686  0.646759  0.646659  0.64656  0.646463  0.646367  0.646272  0.646179  0.646087  0.645997  0.645908  0.64582  0.645733  0.645648  0.645564  0.64548  0.645399  0.645318  0.645238  0.645159  0.645082  0.645005  0.64493  0.644855  0.644782  0.644709  0.644638  0.644567  0.644498  0.644429  0.644361  0.644294  0.644228  0.644163  0.644098  0.644035  0.643972  0.64391  0.643849  0.643788  0.643728  0.643669  0.643611  0.643554  0.643497  0.643441  0.643385  0.64333  0.643276  0.643223  0.64317  0.643118  0.643066  0.643015  0.642965  0.642915  0.642866  0.642817  0.642769  0.642722  0.642675  0.642628  0.642583  0.642537  0.642492  0.642448  0.642404  0.642361  0.642318  0.642276  0.642234  0.642192  0.642151  0.642111  0.642071  0.642031  0.641992  0.641953  0.641915  0.641876  0.641839  0.641802  0.641765  0.641728  0.641692  0.641657  0.641621  0.641586  0.641552  0.641518  0.641485  0.641451  0.641419  0.641386  0.641354  0.641322  0.641291  0.641259  0.641228  0.641197  0.641166  0.641135  0.641105];
plot(x,y,'b');

plot(dot_x,dot_y,'r--');

for i = 1:50
    plot(dot_x(i), dot_y(i), 'r.','MarkerSize', 10);
end

title('F3 Spline Interpolation uniform grid');
legend({'y = 1/(arctg(1 + 10x^2))', 'Spline', 'y = 1/(arctg(1 + 10x^2)), grid', 'Uniform grid n = 50'}, 'Location', 'southeast');

%   xlim ([-3.1 3.1]);
%   ylim ([-0.1 1.1]);

grid on;
hold off
