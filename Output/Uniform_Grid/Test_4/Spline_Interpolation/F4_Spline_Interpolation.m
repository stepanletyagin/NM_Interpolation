% Интерполяция сплайнами F4 равномерная сетка (n = 3)
dot_x=[-1  0  1];
dot_y=[2.44283  -2.1335  2.30435];

x = [-1:0.01:1];
y = (4.*x.^3 + 2.*x.^2 - 4.*x + 2).^(sqrt(2)) + asin(1./(5 + x - x.^2)) - 5;
plot(x,y,'r');
hold on

x=[-1:0.01:1];
y=[2.44283  2.37453  2.30625  2.23799  2.16978  2.10162  2.03352  1.96551  1.89759  1.82978  1.7621  1.69454  1.62714  1.5599  1.49283  1.42596  1.35928  1.29282  1.2266  1.16061  1.09488  1.02943  0.964254  0.899378  0.834814  0.770574  0.706672  0.643121  0.579936  0.517129  0.454714  0.392705  0.331115  0.269958  0.209247  0.148996  0.0892175  0.0299262  -0.0288648  -0.0871421  -0.144892  -0.202101  -0.258756  -0.314842  -0.370348  -0.425258  -0.47956  -0.53324  -0.586285  -0.63868  -0.690413  -0.74147  -0.791837  -0.841501  -0.890449  -0.938666  -0.98614  -1.03286  -1.0788  -1.12396  -1.16833  -1.21188  -1.25461  -1.2965  -1.33754  -1.37771  -1.417  -1.4554  -1.4929  -1.52947  -1.56511  -1.59981  -1.63355  -1.66631  -1.69809  -1.72886  -1.75862  -1.78735  -1.81505  -1.84168  -1.86725  -1.89174  -1.91513  -1.93742  -1.95858  -1.9786  -1.99748  -2.01519  -2.03173  -2.04708  -2.06122  -2.07415  -2.08584  -2.0963  -2.10549  -2.11342  -2.12006  -2.1254  -2.12943  -2.13213  -2.1335  -2.13352  -2.1322  -2.12955  -2.12559  -2.12034  -2.1138  -2.10599  -2.09692  -2.08661  -2.07507  -2.06231  -2.04835  -2.0332  -2.01687  -1.99938  -1.98073  -1.96096  -1.94006  -1.91805  -1.89495  -1.87076  -1.84551  -1.8192  -1.79186  -1.76348  -1.73409  -1.7037  -1.67232  -1.63997  -1.60666  -1.5724  -1.53721  -1.5011  -1.46408  -1.42617  -1.38739  -1.34773  -1.30723  -1.26589  -1.22372  -1.18074  -1.13696  -1.0924  -1.04707  -1.00098  -0.954149  -0.906586  -0.858307  -0.809325  -0.759652  -0.709304  -0.658294  -0.606634  -0.554339  -0.501422  -0.447896  -0.393775  -0.339073  -0.283804  -0.227979  -0.171614  -0.114722  -0.0573156  0.000590932  0.0589842  0.117851  0.177177  0.236949  0.297155  0.357779  0.418809  0.480231  0.542031  0.604197  0.666714  0.72957  0.79275  0.85624  0.920029  0.984101  1.04844  1.11304  1.17789  1.24296  1.30825  1.37374  1.43942  1.50528  1.5713  1.63747  1.70377  1.77019  1.83673  1.90335  1.97006  2.03684  2.10367  2.17054  2.23744  2.30435];
plot(x,y,'b');

% plot(dot_x,dot_y,'r--');

for i = 1:3
    plot(dot_x(i), dot_y(i), 'r.','MarkerSize', 10);
end


title('F4 Spline Interpolation uniform grid');
legend({'y = (4x^3 + 2x^2 - 4x + 2)^(sqrt(2)) + arcsin(1/(5 + x - x^2)) - 5', 'Spline', 'Uniform grid n = 3'}, 'Location', 'southeast');

%  xlim ([-3.1 3.1]);
%  ylim ([-0.1 3.1]);

grid on;
hold off

% Интерполяция сплайнами F4 равномерная сетка (n = 10)
figure;
dot_x = [-1  -0.777778  -0.555556  -0.333333  -0.111111  0.111111  0.333333  0.555556  0.777778  1];
dot_y = [2.44283  3.50998  2.73607  0.883203  -1.21435  -2.88318  -3.75454  -3.69189  -2.17643  2.30435];

x = [-1:0.01:1];
y = (4.*x.^3 + 2.*x.^2 - 4.*x + 2).^(sqrt(2)) + asin(1./(5 + x - x.^2)) - 5;
plot(x,y,'r');
hold on

x=[-1:0.01:1];
y=[2.44283  2.5098  2.57654  2.64282  2.7084  2.77307  2.83658  2.8987  2.95921  3.01788  3.07447  3.12875  3.1805  3.22947  3.27545  3.3182  3.35748  3.39308  3.42475  3.45228  3.47542  3.49394  3.50762  3.51626  3.51988  3.51864  3.51268  3.50214  3.48719  3.46795  3.44458  3.41723  3.38605  3.35117  3.31274  3.27093  3.22586  3.17769  3.12656  3.07262  3.01602  2.95691  2.89542  2.83172  2.76594  2.69823  2.62868  2.55737  2.48435  2.40968  2.33342  2.25563  2.17637  2.0957  2.01367  1.93036  1.84582  1.76011  1.67328  1.58541  1.49654  1.40674  1.31608  1.2246  1.13237  1.03945  0.945893  0.851769  0.757136  0.662065  0.566624  0.470884  0.374915  0.278785  0.182565  0.0863239  -0.00986818  -0.105942  -0.201827  -0.297454  -0.392754  -0.487657  -0.582092  -0.675991  -0.769284  -0.861901  -0.953773  -1.04483  -1.135  -1.22422  -1.31242  -1.39957  -1.48564  -1.57061  -1.65444  -1.73709  -1.81855  -1.89879  -1.97777  -2.05546  -2.13183  -2.20686  -2.28051  -2.35276  -2.42358  -2.49293  -2.56078  -2.62712  -2.6919  -2.75509  -2.81668  -2.87662  -2.9349  -2.99148  -3.04637  -3.09955  -3.15099  -3.2007  -3.24865  -3.29483  -3.33924  -3.38185  -3.42265  -3.46163  -3.49877  -3.53407  -3.56751  -3.59907  -3.62874  -3.65651  -3.68237  -3.70629  -3.72828  -3.7483  -3.76636  -3.78246  -3.79659  -3.80877  -3.81902  -3.82732  -3.83371  -3.83818  -3.84074  -3.84141  -3.84019  -3.83708  -3.83211  -3.82527  -3.81658  -3.80604  -3.79367  -3.77947  -3.76345  -3.74562  -3.72599  -3.70457  -3.68135  -3.65622  -3.62887  -3.59899  -3.56628  -3.53043  -3.49114  -3.44811  -3.40103  -3.34959  -3.29348  -3.23241  -3.16607  -3.09415  -3.01635  -2.93236  -2.84187  -2.74459  -2.6402  -2.52841  -2.40889  -2.28136  -2.14551  -2.00123  -1.84886  -1.68879  -1.52139  -1.34706  -1.16618  -0.979133  -0.786306  -0.588086  -0.384856  -0.177003  0.0350889  0.251034  0.470447  0.692942  0.918134  1.14564  1.37507  1.60604  1.83817  2.07107  2.30435];
plot(x,y,'b');

% plot(dot_x,dot_y,'r--');

for i = 1:10
    plot(dot_x(i), dot_y(i), 'r.','MarkerSize', 10);
end

title('F4 Spline Interpolation uniform grid');
legend({'y = (4x^3 + 2x^2 - 4x + 2)^(sqrt(2)) + arcsin(1/(5 + x - x^2)) - 5', 'Spline', 'Uniform grid n = 10'}, 'Location', 'southeast');

%  xlim ([-1.1 1.1]);
%  ylim ([-0.1 1.1]);

grid on;
hold off

% Интерполяция сплайнами F4 равномерная сетка (n = 50)
figure;
dot_x=[-1  -0.959184  -0.918367  -0.877551  -0.836735  -0.795918  -0.755102  -0.714286  -0.673469  -0.632653  -0.591837  -0.55102  -0.510204  -0.469388  -0.428571  -0.387755  -0.346939  -0.306122  -0.265306  -0.22449  -0.183673  -0.142857  -0.102041  -0.0612245  -0.0204082  0.0204082  0.0612245  0.102041  0.142857  0.183673  0.22449  0.265306  0.306122  0.346939  0.387755  0.428571  0.469388  0.510204  0.55102  0.591837  0.632653  0.673469  0.714286  0.755102  0.795918  0.836735  0.877551  0.918367  0.959184  1];
dot_y=[2.44283  2.80082  3.08388  3.29324  3.43107  3.50031  3.50453  3.44782  3.3347  3.16996  2.9587  2.70614  2.41763  2.09857  1.75435  1.39033  1.01175  0.623705  0.231129  -0.161277  -0.549068  -0.928089  -1.29451  -1.64484  -1.97598  -2.28523  -2.5703  -2.82932  -3.06082  -3.26376  -3.43743  -3.58139  -3.69536  -3.77906  -3.832  -3.85321  -3.84101  -3.7927  -3.70439  -3.57087  -3.38556  -3.14053  -2.8266  -2.43336  -1.94932  -1.36195  -0.657765  0.177661  1.15964  2.30435];

x = [-1:0.01:1];
y = (4.*x.^3 + 2.*x.^2 - 4.*x + 2).^(sqrt(2)) + asin(1./(5 + x - x.^2)) - 5;
plot(x,y,'r');
hold on

x=[-1:0.01:1];
y=[2.44283  2.53419  2.62416  2.71132  2.79427  2.87186  2.94409  3.01135  3.07405  3.13253  3.18684  3.23692  3.2827  3.32411  3.36119  3.394  3.42262  3.44712  3.46755  3.48395  3.49637  3.50486  3.50948  3.51028  3.50733  3.50068  3.49042  3.47659  3.45927  3.43852  3.41441  3.38701  3.35639  3.32263  3.28579  3.24596  3.2032  3.15759  3.10921  3.05813  3.00442  2.94818  2.88947  2.82838  2.76497  2.69934  2.63156  2.5617  2.48986  2.4161  2.34051  2.26317  2.18416  2.10355  2.02143  1.93787  1.85296  1.76677  1.67937  1.59086  1.5013  1.41078  1.31936  1.22713  1.13416  1.04053  0.946309  0.851572  0.756391  0.66084  0.56499  0.468913  0.372678  0.276354  0.18001  0.0837131  -0.0124708  -0.108476  -0.204238  -0.299692  -0.394778  -0.489434  -0.583599  -0.677214  -0.770221  -0.862566  -0.954191  -1.04504  -1.13507  -1.22421  -1.31243  -1.39967  -1.48589  -1.57104  -1.65507  -1.73794  -1.81961  -1.90004  -1.97919  -2.05702  -2.1335  -2.20859  -2.28226  -2.35447  -2.42521  -2.49443  -2.56212  -2.62824  -2.69278  -2.75571  -2.81701  -2.87666  -2.93464  -2.99094  -3.04554  -3.09842  -3.14958  -3.19901  -3.24669  -3.29261  -3.33677  -3.37916  -3.41978  -3.45861  -3.49565  -3.5309  -3.56436  -3.59602  -3.62588  -3.65394  -3.68018  -3.70461  -3.72723  -3.74802  -3.76698  -3.7841  -3.79938  -3.8128  -3.82434  -3.834  -3.84176  -3.84758  -3.85146  -3.85336  -3.85326  -3.85112  -3.8469  -3.84056  -3.83206  -3.82134  -3.80835  -3.79304  -3.77533  -3.75516  -3.73245  -3.70712  -3.6791  -3.6483  -3.61461  -3.57793  -3.53818  -3.49524  -3.449  -3.39933  -3.34611  -3.28923  -3.22854  -3.1639  -3.09519  -3.02226  -2.94494  -2.8631  -2.77657  -2.68519  -2.5888  -2.48723  -2.38031  -2.26785  -2.14968  -2.02561  -1.89544  -1.75898  -1.61607  -1.46651  -1.31012  -1.1467  -0.975955  -0.797622  -0.611423  -0.417172  -0.214865  -0.00451451  0.213863  0.440552  0.676577  0.923071  1.18117  1.45112  1.73037  2.01581  2.30435];
plot(x,y,'b');

% plot(dot_x,dot_y,'r--');

for i = 1:50
    plot(dot_x(i), dot_y(i), 'r.','MarkerSize', 10);
end

title('F4 Spline Interpolation uniform grid');
legend({'y = (4x^3 + 2x^2 - 4x + 2)^(sqrt(2)) + arcsin(1/(5 + x - x^2)) - 5', 'Spline', 'Uniform grid n = 50'}, 'Location', 'southeast');

%   xlim ([-3.1 3.1]);
%   ylim ([-0.1 1.1]);

grid on;
hold off
