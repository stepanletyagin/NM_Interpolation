% Интерполяция Лагранжем F4 равномерная сетка (n = 3)
dot_x=[-1  0  1];
dot_y=[2.44283  -2.1335  2.30435];

x = [-1:0.01:1];
y = (4.*x.^3 + 2.*x.^2 - 4.*x + 2).^(sqrt(2)) + asin(1./(5 + x - x.^2)) - 5;
plot(x,y,'r');
hold on

x=[-1:0.01:1];
y=[2.44283  2.35245  2.26296  2.17438  2.0867  1.99993  1.91405  1.82908  1.745  1.66183  1.57956  1.49819  1.41772  1.33816  1.25949  1.18173  1.10486  1.0289  0.953845  0.879687  0.80643  0.734075  0.662622  0.592069  0.522418  0.453669  0.385821  0.318874  0.252829  0.187685  0.123443  0.0601022  -0.00233729  -0.0638754  -0.124512  -0.184247  -0.243081  -0.301014  -0.358045  -0.414174  -0.469402  -0.523729  -0.577154  -0.629678  -0.681301  -0.732022  -0.781842  -0.83076  -0.878777  -0.925892  -0.972106  -1.01742  -1.06183  -1.10534  -1.14795  -1.18965  -1.23046  -1.27036  -1.30937  -1.34747  -1.38467  -1.42097  -1.45636  -1.49086  -1.52445  -1.55715  -1.58894  -1.61983  -1.64982  -1.6789  -1.70709  -1.73437  -1.76076  -1.78624  -1.81082  -1.8345  -1.85727  -1.87915  -1.90012  -1.9202  -1.93937  -1.95764  -1.97501  -1.99147  -2.00704  -2.0217  -2.03547  -2.04833  -2.06029  -2.07135  -2.0815  -2.09076  -2.09911  -2.10657  -2.11312  -2.11877  -2.12352  -2.12736  -2.13031  -2.13235  -2.1335  -2.13374  -2.13308  -2.13152  -2.12906  -2.12569  -2.12143  -2.11626  -2.11019  -2.10322  -2.09535  -2.08658  -2.0769  -2.06633  -2.05485  -2.04247  -2.02919  -2.01501  -1.99993  -1.98395  -1.96706  -1.94928  -1.93059  -1.911  -1.89051  -1.86911  -1.84682  -1.82363  -1.79953  -1.77453  -1.74863  -1.72183  -1.69413  -1.66553  -1.63602  -1.60561  -1.57431  -1.5421  -1.50899  -1.47497  -1.44006  -1.40424  -1.36753  -1.32991  -1.29139  -1.25197  -1.21165  -1.17042  -1.1283  -1.08527  -1.04135  -0.996516  -0.950786  -0.904154  -0.85662  -0.808185  -0.758849  -0.708611  -0.657472  -0.605432  -0.55249  -0.498646  -0.443902  -0.388255  -0.331708  -0.274259  -0.215908  -0.156656  -0.096503  -0.0354483  0.0265079  0.0893654  0.153124  0.217785  0.283347  0.34981  0.417174  0.485441  0.554608  0.624677  0.695647  0.767519  0.840292  0.913967  0.988543  1.06402  1.1404  1.21768  1.29586  1.37494  1.45493  1.53581  1.6176  1.70029  1.78388  1.86837  1.95377  2.04006  2.12726  2.21535  2.30435];
plot(x,y,'b');

% plot(dot_x,dot_y,'r--');

for i = 1:3
    plot(dot_x(i), dot_y(i), 'r.','MarkerSize', 10);
end


title('F4 Lagrange Interpolation uniform grid');
legend({'y = (4x^3 + 2x^2 - 4x + 2)^(sqrt(2)) + arcsin(1/(5 + x - x^2)) - 5', 'Ln(x)', 'Uniform grid n = 3'}, 'Location', 'southeast');

%  xlim ([-1.1 1.1]);
%  ylim ([-0.1 1.1]);

grid on;
hold off

% Интерполяция Лагранжем F4 равномерная сетка (n = 10)
figure;
dot_x = [-1  -0.777778  -0.555556  -0.333333  -0.111111  0.111111  0.333333  0.555556  0.777778  1];
dot_y = [2.44283  3.50998  2.73607  0.883203  -1.21435  -2.88318  -3.75454  -3.69189  -2.17643  2.30435];

x = [-1:0.01:1];
y = (4.*x.^3 + 2.*x.^2 - 4.*x + 2).^(sqrt(2)) + asin(1./(5 + x - x.^2)) - 5;
plot(x,y,'r');
hold on

x=[-1:0.01:1];
y=[2.44283  2.53284  2.61945  2.7025  2.78184  2.85736  2.92896  2.99654  3.06003  3.11939  3.17456  3.22553  3.27226  3.31475  3.35301  3.38704  3.41687  3.44251  3.464  3.48138  3.4947  3.50399  3.50933  3.51075  3.50833  3.50213  3.49222  3.47866  3.46153  3.4409  3.41685  3.38944  3.35878  3.32492  3.28795  3.24795  3.205  3.15918  3.11058  3.05928  3.00535  2.94888  2.88996  2.82865  2.76505  2.69924  2.6313  2.5613  2.48933  2.41547  2.3398  2.26239  2.18334  2.1027  2.02058  1.93703  1.85214  1.76599  1.67865  1.59021  1.50072  1.41028  1.31895  1.2268  1.13393  1.04038  0.946251  0.851599  0.7565  0.661025  0.565244  0.469228  0.373045  0.276765  0.180455  0.084182  -0.0119873  -0.107988  -0.203754  -0.299223  -0.394331  -0.489017  -0.583219  -0.676879  -0.769936  -0.862334  -0.954016  -1.04493  -1.13501  -1.22422  -1.3125  -1.3998  -1.48607  -1.57127  -1.65534  -1.73825  -1.81996  -1.90041  -1.97958  -2.05742  -2.13391  -2.20899  -2.28265  -2.35485  -2.42555  -2.49474  -2.56239  -2.62847  -2.69295  -2.75583  -2.81707  -2.87666  -2.93459  -2.99083  -3.04537  -3.09821  -3.14932  -3.1987  -3.24634  -3.29224  -3.33637  -3.37875  -3.41936  -3.45819  -3.49524  -3.53052  -3.564  -3.5957  -3.6256  -3.6537  -3.67999  -3.70448  -3.72715  -3.748  -3.76702  -3.78419  -3.79952  -3.81298  -3.82457  -3.83426  -3.84203  -3.84787  -3.85176  -3.85366  -3.85354  -3.85138  -3.84713  -3.84075  -3.83221  -3.82146  -3.80843  -3.79308  -3.77534  -3.75515  -3.73243  -3.70711  -3.67911  -3.64834  -3.61471  -3.57813  -3.53848  -3.49565  -3.44955  -3.40003  -3.34698  -3.29027  -3.22975  -3.16528  -3.09672  -3.02391  -2.94669  -2.8649  -2.77836  -2.6869  -2.59035  -2.48853  -2.38124  -2.2683  -2.14952  -2.02471  -1.89368  -1.75623  -1.61216  -1.46129  -1.30342  -1.13838  -0.965958  -0.785995  -0.598313  -0.402746  -0.199138  0.012658  0.232777  0.461342  0.698457  0.944215  1.19869  1.46192  1.73394  2.01476  2.30435];
plot(x,y,'b');

% plot(dot_x,dot_y,'r--');

for i = 1:10
    plot(dot_x(i), dot_y(i), 'r.','MarkerSize', 10);
end

title('F4 Lagrange Interpolation uniform grid');
legend({'y = (4x^3 + 2x^2 - 4x + 2)^(sqrt(2)) + arcsin(1/(5 + x - x^2)) - 5', 'Ln(x)', 'Uniform grid n = 10'}, 'Location', 'southeast');

%  xlim ([-1.1 1.1]);
%  ylim ([-0.7 1.1]);

grid on;
hold off

% Интерполяция Лагранжем F4 равномерная сетка (n = 50)
figure;
dot_x=[-1  -0.959184  -0.918367  -0.877551  -0.836735  -0.795918  -0.755102  -0.714286  -0.673469  -0.632653  -0.591837  -0.55102  -0.510204  -0.469388  -0.428571  -0.387755  -0.346939  -0.306122  -0.265306  -0.22449  -0.183673  -0.142857  -0.102041  -0.0612245  -0.0204082  0.0204082  0.0612245  0.102041  0.142857  0.183673  0.22449  0.265306  0.306122  0.346939  0.387755  0.428571  0.469388  0.510204  0.55102  0.591837  0.632653  0.673469  0.714286  0.755102  0.795918  0.836735  0.877551  0.918367  0.959184  1];
dot_y=[2.44283  2.80082  3.08388  3.29324  3.43107  3.50031  3.50453  3.44782  3.3347  3.16996  2.9587  2.70614  2.41763  2.09857  1.75435  1.39033  1.01175  0.623705  0.231129  -0.161277  -0.549068  -0.928089  -1.29451  -1.64484  -1.97598  -2.28523  -2.5703  -2.82932  -3.06082  -3.26376  -3.43743  -3.58139  -3.69536  -3.77906  -3.832  -3.85321  -3.84101  -3.7927  -3.70439  -3.57087  -3.38556  -3.14053  -2.8266  -2.43336  -1.94932  -1.36195  -0.657765  0.177661  1.15964  2.30435];

x = [-1:0.01:1];
y = (4.*x.^3 + 2.*x.^2 - 4.*x + 2).^(sqrt(2)) + asin(1./(5 + x - x.^2)) - 5;
plot(x,y,'r');
hold on

x=[-1:0.01:1];
y=[2.44283  2.53981  2.62792  2.71334  2.7944  2.87096  2.9431  3.01078  3.07398  3.13275  3.18711  3.23709  3.28273  3.32406  3.36112  3.39396  3.42261  3.44713  3.46757  3.48396  3.49638  3.50486  3.50947  3.51028  3.50733  3.50069  3.49042  3.47659  3.45927  3.43852  3.41441  3.38701  3.35639  3.32263  3.28579  3.24596  3.2032  3.15759  3.10921  3.05813  3.00443  2.94818  2.88947  2.82838  2.76497  2.69934  2.63156  2.5617  2.48986  2.4161  2.34051  2.26317  2.18416  2.10355  2.02143  1.93787  1.85296  1.76677  1.67937  1.59086  1.5013  1.41078  1.31936  1.22713  1.13416  1.04053  0.946309  0.851571  0.756391  0.66084  0.56499  0.468913  0.372678  0.276354  0.18001  0.0837124  -0.0124714  -0.108476  -0.204238  -0.299693  -0.394779  -0.489434  -0.583599  -0.677214  -0.770222  -0.862566  -0.954191  -1.04504  -1.13507  -1.22421  -1.31243  -1.39967  -1.48589  -1.57104  -1.65507  -1.73794  -1.81961  -1.90004  -1.97919  -2.05702  -2.1335  -2.20859  -2.28226  -2.35447  -2.42521  -2.49443  -2.56212  -2.62824  -2.69278  -2.75571  -2.81701  -2.87666  -2.93464  -2.99094  -3.04554  -3.09842  -3.14959  -3.19901  -3.24669  -3.29261  -3.33677  -3.37916  -3.41978  -3.45861  -3.49565  -3.5309  -3.56436  -3.59602  -3.62588  -3.65394  -3.68018  -3.70461  -3.72723  -3.74802  -3.76698  -3.7841  -3.79938  -3.8128  -3.82434  -3.834  -3.84175  -3.84758  -3.85146  -3.85336  -3.85326  -3.85112  -3.8469  -3.84056  -3.83206  -3.82134  -3.80835  -3.79304  -3.77533  -3.75515  -3.73245  -3.70712  -3.6791  -3.64829  -3.6146  -3.57793  -3.53818  -3.49524  -3.44899  -3.39933  -3.34611  -3.28923  -3.22853  -3.1639  -3.09519  -3.02225  -2.94494  -2.8631  -2.77657  -2.68519  -2.5888  -2.48723  -2.3803  -2.26784  -2.14967  -2.0256  -1.89544  -1.75901  -1.61611  -1.46654  -1.3101  -1.14658  -0.975785  -0.797491  -0.611489  -0.417559  -0.215481  -0.00502999  0.214022  0.441909  0.678844  0.925124  1.18087  1.44604  1.72172  2.00738  2.30435];
plot(x,y,'b');

% plot(dot_x,dot_y,'r--');

for i = 1:50
    plot(dot_x(i), dot_y(i), 'r.','MarkerSize', 10);
end

title('F4 Lagrange Interpolation uniform grid');
legend({'y = (4x^3 + 2x^2 - 4x + 2)^(sqrt(2)) + arcsin(1/(5 + x - x^2)) - 5', 'Ln(x)', 'Uniform grid n = 50'}, 'Location', 'southeast');

% xlim ([-3.1 3.1]);
% ylim ([-6 2]);

grid on;
hold off
