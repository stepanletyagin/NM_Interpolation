% Интерполяция сплайнами F2 равномерная сетка (n = 3)
dot_x=[-1  0  1];
dot_y=[0.0384615  1  0.0384615];

x = [-1:0.01:1];
y = 1./(1+25.*x.^2);
plot(x,y,'r');
hold on

x=[-1:0.01:1];
y=[0.0384615  0.0528841  0.0673038  0.0817178  0.0961231  0.110517  0.124896  0.139258  0.1536  0.167919  0.182212  0.196475  0.210708  0.224905  0.239065  0.253185  0.267262  0.281292  0.295273  0.309202  0.323077  0.336894  0.35065  0.364343  0.377969  0.391526  0.405012  0.418422  0.431754  0.445005  0.458173  0.471254  0.484246  0.497146  0.50995  0.522656  0.535262  0.547763  0.560158  0.572443  0.584615  0.596673  0.608612  0.620429  0.632123  0.64369  0.655127  0.666431  0.6776  0.68863  0.699519  0.710264  0.720862  0.731309  0.741604  0.751743  0.761723  0.771542  0.781196  0.790683  0.8  0.809144  0.818112  0.8269  0.835508  0.84393  0.852165  0.86021  0.868062  0.875717  0.883173  0.890427  0.897477  0.904319  0.91095  0.917368  0.923569  0.929551  0.935312  0.940847  0.946154  0.95123  0.956073  0.960679  0.965046  0.969171  0.97305  0.976681  0.980062  0.983188  0.986058  0.988668  0.991015  0.993098  0.994912  0.996454  0.997723  0.998715  0.999427  0.999856  1  0.999856  0.999427  0.998715  0.997723  0.996454  0.994912  0.993098  0.991015  0.988668  0.986058  0.983188  0.980062  0.976681  0.97305  0.969171  0.965046  0.960679  0.956073  0.95123  0.946154  0.940847  0.935312  0.929551  0.923569  0.917368  0.91095  0.904319  0.897477  0.890427  0.883173  0.875717  0.868062  0.86021  0.852165  0.84393  0.835508  0.8269  0.818112  0.809144  0.8  0.790683  0.781196  0.771542  0.761723  0.751743  0.741604  0.731309  0.720862  0.710264  0.699519  0.68863  0.6776  0.666431  0.655127  0.64369  0.632123  0.620429  0.608612  0.596673  0.584615  0.572443  0.560158  0.547763  0.535262  0.522656  0.50995  0.497146  0.484246  0.471254  0.458173  0.445005  0.431754  0.418422  0.405012  0.391526  0.377969  0.364343  0.35065  0.336894  0.323077  0.309202  0.295273  0.281292  0.267262  0.253185  0.239065  0.224905  0.210708  0.196475  0.182212  0.167919  0.1536  0.139258  0.124896  0.110517  0.0961231  0.0817178  0.0673038  0.0528841  0.0384615];
plot(x,y,'b');

plot(dot_x,dot_y,'r--');

for i = 1:3
    plot(dot_x(i), dot_y(i), 'r.','MarkerSize', 10);
end


title('F2 Spline Interpolation uniform grid');
legend({'y = 1/(1+25*x^2)', 'Spline', 'y = 1/(1+25*x^2), grid', 'Uniform grid n = 3'}, 'Location', 'southeast');

%  xlim ([-3.1 3.1]);
%  ylim ([-0.1 3.1]);

grid on;
hold off

% Интерполяция сплайнами F2 равномерная сетка (n = 10)
figure;
dot_x = [-1  -0.777778  -0.555556  -0.333333  -0.111111  0.111111  0.333333  0.555556  0.777778  1];
dot_y = [0.0384615  0.0620214  0.114731  0.264706  0.764151  0.764151  0.264706  0.114731  0.0620214  0.0384615 ];

x = [-1:0.01:1];
y = 1./(1+25.*x.^2);
plot(x,y,'r');
hold on

x=[-1:0.01:1];
y=[0.0384615  0.0391034  0.0397504  0.0404076  0.04108  0.0417728  0.0424911  0.0432399  0.0440244  0.0448497  0.0457207  0.0466427  0.0476207  0.0486598  0.0497652  0.0509418  0.0521948  0.0535293  0.0549504  0.0564631  0.0580727  0.059784  0.0616023  0.0635315  0.0655665  0.0676977  0.0699156  0.0722106  0.0745734  0.0769942  0.0794637  0.0819723  0.0845104  0.0870685  0.0896371  0.0922067  0.0947678  0.0973107  0.0998261  0.102304  0.104736  0.107111  0.109421  0.111655  0.113805  0.115863  0.117862  0.119872  0.121963  0.124206  0.12667  0.129426  0.132543  0.136093  0.140146  0.144771  0.15004  0.156022  0.162787  0.170406  0.178949  0.188487  0.199089  0.210826  0.223768  0.237985  0.253548  0.270526  0.288912  0.308582  0.329403  0.351242  0.373964  0.397437  0.421526  0.446098  0.471019  0.496156  0.521375  0.546543  0.571526  0.59619  0.620402  0.644028  0.666935  0.688989  0.710056  0.730003  0.748696  0.766001  0.781816  0.796125  0.808928  0.820224  0.830014  0.838298  0.845076  0.850348  0.854113  0.856373  0.857126  0.856373  0.854113  0.850348  0.845076  0.838298  0.830014  0.820224  0.808928  0.796125  0.781816  0.766001  0.748696  0.730003  0.710056  0.688989  0.666935  0.644028  0.620402  0.59619  0.571526  0.546543  0.521375  0.496156  0.471019  0.446098  0.421526  0.397437  0.373964  0.351242  0.329403  0.308582  0.288912  0.270526  0.253548  0.237985  0.223768  0.210826  0.199089  0.188487  0.178949  0.170406  0.162787  0.156022  0.15004  0.144771  0.140146  0.136093  0.132543  0.129426  0.12667  0.124206  0.121963  0.119872  0.117862  0.115863  0.113805  0.111655  0.109421  0.107111  0.104736  0.102304  0.0998261  0.0973107  0.0947678  0.0922067  0.0896371  0.0870685  0.0845104  0.0819723  0.0794637  0.0769942  0.0745734  0.0722106  0.0699156  0.0676977  0.0655665  0.0635315  0.0616023  0.059784  0.0580727  0.0564631  0.0549504  0.0535293  0.0521948  0.0509418  0.0497652  0.0486598  0.0476207  0.0466427  0.0457207  0.0448497  0.0440244  0.0432399  0.0424911  0.0417728  0.04108  0.0404076  0.0397504  0.0391034  0.0384615];
plot(x,y,'b');

plot(dot_x,dot_y,'r--');

for i = 1:10
    plot(dot_x(i), dot_y(i), 'r.','MarkerSize', 10);
end

title('F2 Spline Interpolation uniform grid');
legend({'y = 1/(1+25*x^2)', 'Spline', 'y = 1/(1+25*x^2), grid', 'Uniform grid n = 10'}, 'Location', 'southeast');

%  xlim ([-1.1 1.1]);
%  ylim ([-0.1 1.1]);

grid on;
hold off

% Интерполяция сплайнами F2 равномерная сетка (n = 50)
figure;
dot_x=[-1  -0.959184  -0.918367  -0.877551  -0.836735  -0.795918  -0.755102  -0.714286  -0.673469  -0.632653  -0.591837  -0.55102  -0.510204  -0.469388  -0.428571  -0.387755  -0.346939  -0.306122  -0.265306  -0.22449  -0.183673  -0.142857  -0.102041  -0.0612245  -0.0204082  0.0204082  0.0612245  0.102041  0.142857  0.183673  0.22449  0.265306  0.306122  0.346939  0.387755  0.428571  0.469388  0.510204  0.55102  0.591837  0.632653  0.673469  0.714286  0.755102  0.795918  0.836735  0.877551  0.918367  0.959184  1];
dot_y=[0.0384615  0.0416652  0.0452797  0.0493769  0.0540449  0.0593925  0.0655545  0.0727003  0.0810437  0.0908575  0.102493  0.116406  0.133196  0.153654  0.178832  0.210135  0.249429  0.299153  0.36236  0.442499  0.542476  0.662162  0.793457  0.914318  0.989695  0.989695  0.914318  0.793457  0.662162  0.542476  0.442499  0.36236  0.299153  0.249429  0.210135  0.178832  0.153654  0.133196  0.116406  0.102493  0.0908575  0.0810437  0.0727003  0.0655545  0.0593925  0.0540449  0.0493769  0.0452797  0.0416652  0.0384615];

x = [-1:0.01:1];
y = 1./(1+25.*x.^2);
plot(x,y,'r');
hold on

x=[-1:0.01:1];
y=[0.0384615  0.0392272  0.0400002  0.0407879  0.0415979  0.0424364  0.0433043  0.0442011  0.045126  0.0460786  0.04706  0.0480719  0.049116  0.0501942  0.051308  0.0524588  0.053648  0.0548772  0.0561482  0.057463  0.0588235  0.0602318  0.0616902  0.063201  0.0647668  0.06639  0.0680734  0.0698201  0.0716332  0.0735159  0.0754715  0.0775042  0.0796178  0.0818163  0.0841041  0.0864863  0.0889679  0.0915541  0.0942505  0.0970635  0.0999999  0.103066  0.10627  0.109619  0.113122  0.116788  0.120627  0.124649  0.128866  0.133289  0.137931  0.142805  0.147929  0.153315  0.158982  0.164947  0.171232  0.177857  0.184842  0.192214  0.199999  0.208225  0.216919  0.226115  0.235848  0.246154  0.257069  0.268635  0.280897  0.293901  0.307692  0.32232  0.337837  0.354295  0.371748  0.390246  0.409837  0.43057  0.452492  0.475634  0.500008  0.525624  0.552492  0.580576  0.609781  0.640005  0.671147  0.703029  0.735346  0.767776  0.800001  0.831629  0.862118  0.890905  0.917425  0.941126  0.961484  0.97798  0.990097  0.997413  0.999852  0.997413  0.990097  0.97798  0.961484  0.941126  0.917425  0.890905  0.862118  0.831629  0.800001  0.767776  0.735346  0.703029  0.671147  0.640005  0.609781  0.580576  0.552492  0.525624  0.500008  0.475634  0.452492  0.43057  0.409837  0.390246  0.371748  0.354295  0.337837  0.32232  0.307692  0.293901  0.280897  0.268635  0.257069  0.246154  0.235848  0.226115  0.216919  0.208225  0.199999  0.192214  0.184842  0.177857  0.171232  0.164947  0.158982  0.153315  0.147929  0.142805  0.137931  0.133289  0.128866  0.124649  0.120627  0.116788  0.113122  0.109619  0.10627  0.103066  0.0999999  0.0970635  0.0942505  0.0915541  0.0889679  0.0864863  0.0841041  0.0818163  0.0796178  0.0775042  0.0754715  0.0735159  0.0716332  0.0698201  0.0680734  0.06639  0.0647668  0.063201  0.0616902  0.0602318  0.0588235  0.057463  0.0561482  0.0548772  0.053648  0.0524588  0.051308  0.0501942  0.049116  0.0480719  0.04706  0.0460786  0.045126  0.0442011  0.0433043  0.0424364  0.0415979  0.0407879  0.0400002  0.0392272  0.0384615];
plot(x,y,'b');

plot(dot_x,dot_y,'r--');

for i = 1:50
    plot(dot_x(i), dot_y(i), 'r.','MarkerSize', 10);
end

title('F2 Spline Interpolation uniform grid');
legend({'y = 1/(1+25*x^2)', 'Spline', 'y = 1/(1+25*x^2), grid', 'Uniform grid n = 50'}, 'Location', 'southeast');

%   xlim ([-3.1 3.1]);
%   ylim ([-0.1 1.1]);

grid on;
hold off
