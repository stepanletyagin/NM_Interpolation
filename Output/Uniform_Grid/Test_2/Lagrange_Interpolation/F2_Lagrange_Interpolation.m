% Интерполяция Лагранжем F2 равномерная сетка (n = 3)
dot_x=[-1  0  1];
dot_y=[0.0384615  1  0.0384615];

x = [-1:0.01:1];
y = 1./(1+25.*x.^2);
plot(x,y,'r');
hold on

x=[-1:0.01:1];
y=[0.0384615  0.0575962  0.0765385  0.0952885  0.113846  0.132212  0.150385  0.168365  0.186154  0.20375  0.221154  0.238365  0.255385  0.272212  0.288846  0.305288  0.321538  0.337596  0.353462  0.369135  0.384615  0.399904  0.415  0.429904  0.444615  0.459135  0.473462  0.487596  0.501538  0.515288  0.528846  0.542212  0.555385  0.568365  0.581154  0.59375  0.606154  0.618365  0.630385  0.642212  0.653846  0.665288  0.676538  0.687596  0.698462  0.709135  0.719615  0.729904  0.74  0.749904  0.759615  0.769135  0.778462  0.787596  0.796538  0.805288  0.813846  0.822212  0.830385  0.838365  0.846154  0.85375  0.861154  0.868365  0.875385  0.882212  0.888846  0.895288  0.901538  0.907596  0.913462  0.919135  0.924615  0.929904  0.935  0.939904  0.944615  0.949135  0.953462  0.957596  0.961538  0.965288  0.968846  0.972212  0.975385  0.978365  0.981154  0.98375  0.986154  0.988365  0.990385  0.992212  0.993846  0.995288  0.996538  0.997596  0.998462  0.999135  0.999615  0.999904  1  0.999904  0.999615  0.999135  0.998462  0.997596  0.996538  0.995288  0.993846  0.992212  0.990385  0.988365  0.986154  0.98375  0.981154  0.978365  0.975385  0.972212  0.968846  0.965288  0.961538  0.957596  0.953462  0.949135  0.944615  0.939904  0.935  0.929904  0.924615  0.919135  0.913462  0.907596  0.901538  0.895288  0.888846  0.882212  0.875385  0.868365  0.861154  0.85375  0.846154  0.838365  0.830385  0.822212  0.813846  0.805288  0.796538  0.787596  0.778462  0.769135  0.759615  0.749904  0.74  0.729904  0.719615  0.709135  0.698462  0.687596  0.676538  0.665288  0.653846  0.642212  0.630385  0.618365  0.606154  0.59375  0.581154  0.568365  0.555385  0.542212  0.528846  0.515288  0.501538  0.487596  0.473462  0.459135  0.444615  0.429904  0.415  0.399904  0.384615  0.369135  0.353462  0.337596  0.321538  0.305288  0.288846  0.272212  0.255385  0.238365  0.221154  0.20375  0.186154  0.168365  0.150385  0.132212  0.113846  0.0952885  0.0765385  0.0575962  0.0384615];
plot(x,y,'b');

plot(dot_x,dot_y,'r--');

for i = 1:3
    plot(dot_x(i), dot_y(i), 'r.','MarkerSize', 10);
end


title('F2 Lagrange Interpolation uniform grid');
legend({'y = 1/(1+25*x^2)', 'Ln(x)', 'y = 1/(1+25*x^2), grid', 'Uniform grid n = 3'}, 'Location', 'southeast');

%  xlim ([-1.1 1.1]);
%  ylim ([-0.1 1.1]);

grid on;
hold off

% Интерполяция Лагранжем F2 равномерная сетка (n = 10)
figure;
dot_x = [-1  -0.777778  -0.555556  -0.333333  -0.111111  0.111111  0.333333  0.555556  0.777778  1];
dot_y = [0.0384615  0.0620214  0.114731  0.264706  0.764151  0.764151  0.264706  0.114731  0.0620214  0.0384615];

x = [-1:0.01:1];
y = 1./(1+25.*x.^2);
plot(x,y,'r');
hold on

x=[-1:0.01:1];
y=[0.0384615  -0.0501555  -0.119692  -0.172463  -0.210595  -0.236037  -0.250572  -0.255826  -0.253275  -0.244258  -0.229981  -0.211529  -0.189871  -0.165869  -0.140286  -0.113791  -0.086966  -0.0603129  -0.03426  -0.00916664  0.0146705  0.0370125  0.0576732  0.0765147  0.0934422  0.1084  0.121369  0.13236  0.141411  0.148587  0.153972  0.157669  0.159797  0.160485  0.159877  0.158121  0.155372  0.151791  0.147537  0.142774  0.137661  0.132357  0.127017  0.121791  0.116821  0.112245  0.108194  0.104786  0.102136  0.100346  0.0995082  0.0997068  0.101014  0.103492  0.107193  0.112158  0.118417  0.125989  0.134886  0.145106  0.156639  0.169466  0.183557  0.198875  0.215373  0.232998  0.251688  0.271374  0.291982  0.31343  0.335632  0.358497  0.381929  0.40583  0.430098  0.454628  0.479313  0.504047  0.528719  0.553222  0.577448  0.601288  0.624638  0.647393  0.669452  0.690718  0.711094  0.73049  0.74882  0.766001  0.781957  0.796617  0.809915  0.821792  0.832195  0.841077  0.848399  0.854128  0.858239  0.860712  0.861538  0.860712  0.858239  0.854128  0.848399  0.841077  0.832195  0.821792  0.809915  0.796617  0.781957  0.766001  0.74882  0.73049  0.711094  0.690718  0.669452  0.647393  0.624638  0.601288  0.577448  0.553222  0.528719  0.504047  0.479313  0.454628  0.430098  0.40583  0.381929  0.358497  0.335632  0.31343  0.291982  0.271374  0.251688  0.232998  0.215373  0.198875  0.183557  0.169466  0.156639  0.145106  0.134886  0.125989  0.118417  0.112158  0.107193  0.103492  0.101014  0.0997068  0.0995082  0.100346  0.102136  0.104786  0.108194  0.112245  0.116821  0.121791  0.127017  0.132357  0.137661  0.142774  0.147537  0.151791  0.155372  0.158121  0.159877  0.160485  0.159797  0.157669  0.153972  0.148587  0.141411  0.13236  0.121369  0.1084  0.0934422  0.0765147  0.0576732  0.0370125  0.0146705  -0.00916664  -0.03426  -0.0603129  -0.086966  -0.113791  -0.140286  -0.165869  -0.189871  -0.211529  -0.229981  -0.244258  -0.253275  -0.255826  -0.250572  -0.236037  -0.210595  -0.172463  -0.119692  -0.0501555  0.0384615];
plot(x,y,'b');

plot(dot_x,dot_y,'r--');

for i = 1:10
    plot(dot_x(i), dot_y(i), 'r.','MarkerSize', 10);
end

title('F2 Lagrange Interpolation uniform grid');
legend({'y = 1/(1+25*x^2)', 'Ln(x)', 'y = 1/(1+25*x^2), grid', 'Uniform grid n = 10'}, 'Location', 'southeast');

%  xlim ([-1.1 1.1]);
%  ylim ([-0.7 1.1]);

grid on;
hold off

% Интерполяция Лагранжем F2 равномерная сетка (n = 50)
figure;
dot_x=[-1  -0.959184  -0.918367  -0.877551  -0.836735  -0.795918  -0.755102  -0.714286  -0.673469  -0.632653  -0.591837  -0.55102  -0.510204  -0.469388  -0.428571  -0.387755  -0.346939  -0.306122  -0.265306  -0.22449  -0.183673  -0.142857  -0.102041  -0.0612245  -0.0204082  0.0204082  0.0612245  0.102041  0.142857  0.183673  0.22449  0.265306  0.306122  0.346939  0.387755  0.428571  0.469388  0.510204  0.55102  0.591837  0.632653  0.673469  0.714286  0.755102  0.795918  0.836735  0.877551  0.918367  0.959184  1];
dot_y=[0.0384615  0.0416652  0.0452797  0.0493769  0.0540449  0.0593925  0.0655545  0.0727003  0.0810437  0.0908575  0.102493  0.116406  0.133196  0.153654  0.178832  0.210135  0.249429  0.299153  0.36236  0.442499  0.542476  0.662162  0.793457  0.914318  0.989695  0.989695  0.914318  0.793457  0.662162  0.542476  0.442499  0.36236  0.299153  0.249429  0.210135  0.178832  0.153654  0.133196  0.116406  0.102493  0.0908575  0.0810437  0.0727003  0.0655545  0.0593925  0.0540449  0.0493769  0.0452797  0.0416652  0.0384615];

x = [-1:0.01:1];
y = 1./(1+25.*x.^2);
plot(x,y,'r');
hold on

x=[-1:0.01:1];
y=[0.0384615  -651586  -358814  -107934  -3908  17957.5  12670.8  4717.78  370.186  -888.682  -750.077  -325.756  -39.8732  63.8226  62.9593  31.0679  5.2402  -5.95947  -6.82714  -3.73498  -0.745609  0.763852  0.997588  0.63373  0.211453  -0.0317536  -0.0850461  -0.0327743  0.0406241  0.0893364  0.104938  0.0991084  0.087129  0.0789529  0.0775462  0.0812398  0.0869031  0.0921169  0.095917  0.0985163  0.100639  0.102952  0.105791  0.109165  0.112901  0.116809  0.120781  0.124809  0.128951  0.133287  0.137876  0.142744  0.147892  0.153314  0.159004  0.164975  0.17125  0.177859  0.184833  0.192202  0.199991  0.208223  0.216924  0.226123  0.235854  0.246155  0.257067  0.268633  0.280896  0.293901  0.307694  0.322323  0.33784  0.354297  0.371746  0.390242  0.409834  0.43057  0.452489  0.475626  0.500001  0.525625  0.552486  0.58055  0.609755  0.639999  0.671141  0.702989  0.735295  0.767755  0.8  0.8316  0.862068  0.890868  0.917431  0.941177  0.96154  0.977996  0.990099  0.997505  0.999999  0.997505  0.990099  0.977996  0.96154  0.941177  0.917431  0.890868  0.862068  0.8316  0.8  0.767755  0.735295  0.702989  0.671141  0.639999  0.609755  0.58055  0.552486  0.525625  0.500001  0.475626  0.452489  0.43057  0.409834  0.390242  0.371746  0.354297  0.33784  0.322323  0.307694  0.293901  0.280896  0.268633  0.257067  0.246155  0.235854  0.226123  0.216924  0.208223  0.199991  0.192202  0.184833  0.177859  0.17125  0.164975  0.159004  0.153314  0.147892  0.142744  0.137876  0.133287  0.128951  0.124809  0.120781  0.116809  0.112901  0.109165  0.105791  0.102952  0.100639  0.0985163  0.095917  0.0921169  0.0869031  0.0812398  0.0775462  0.0789529  0.087129  0.0991084  0.104938  0.0893364  0.0406241  -0.0327743  -0.0850461  -0.0317537  0.211453  0.63373  0.997588  0.763852  -0.745609  -3.73498  -6.82714  -5.95947  5.2402  31.0679  62.9593  63.8226  -39.8732  -325.756  -750.077  -888.682  370.186  4717.78  12670.8  17957.5  -3908  -107934  -358814  -651586  0.0384615];
plot(x,y,'b');

plot(dot_x,dot_y,'r--');

for i = 1:50
    plot(dot_x(i), dot_y(i), 'r.','MarkerSize', 10);
end

title('F2 Lagrange Interpolation uniform grid');
legend({'y = 1/(1+25*x^2)', 'Ln(x)', 'y = 1/(1+25*x^2), grid', 'Uniform grid n = 50'}, 'Location', 'southeast');

xlim ([-1.1 1.1]);
ylim ([-1 2]);

grid on;
hold off

% Интерполяция Лагранжем F = 5 равномерная сетка (n = 100)
figure;
dot_x=[-1  -0.979798  -0.959596  -0.939394  -0.919192  -0.89899  -0.878788  -0.858586  -0.838384  -0.818182  -0.79798  -0.777778  -0.757576  -0.737374  -0.717172  -0.69697  -0.676768  -0.656566  -0.636364  -0.616162  -0.59596  -0.575758  -0.555556  -0.535354  -0.515152  -0.494949  -0.474747  -0.454545  -0.434343  -0.414141  -0.393939  -0.373737  -0.353535  -0.333333  -0.313131  -0.292929  -0.272727  -0.252525  -0.232323  -0.212121  -0.191919  -0.171717  -0.151515  -0.131313  -0.111111  -0.0909091  -0.0707071  -0.0505051  -0.030303  -0.010101  0.010101  0.030303  0.0505051  0.0707071  0.0909091  0.111111  0.131313  0.151515  0.171717  0.191919  0.212121  0.232323  0.252525  0.272727  0.292929  0.313131  0.333333  0.353535  0.373737  0.393939  0.414141  0.434343  0.454545  0.474747  0.494949  0.515152  0.535354  0.555556  0.575758  0.59596  0.616162  0.636364  0.656566  0.676768  0.69697  0.717172  0.737374  0.757576  0.777778  0.79798  0.818182  0.838384  0.858586  0.878788  0.89899  0.919192  0.939394  0.959596  0.979798  1];
dot_y=[5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5];

x = [-1:0.01:1];
y = 5;
plot(x,y,'r');
hold on

x=[-1:0.01:1];
y=[5  1.90223e+10  2.27905e+09  -6.85283e+09  1.95702e+06  941420  2.18824e+06  -228958  171088  -82022.5  1686.64  27386.5  460.666  -638.058  -104.967  90.997  3.85331  5.08039  5.76386  4.71657  5.11174  4.86452  5.00366  4.97627  5.00057  5.00171  5.00044  4.99946  5.00001  4.99995  5  4.99998  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5  5.00001  5.00002  5.00004  4.99986  4.99955  5.00049  5.00533  5.01383  4.99679  5.01339  5.21215  4.68636  6.16384  13.8888  4.65515  163.191  62.9057  -61.1494  1583.8  -18976.4  3111.88  -492705  64702.4  -2.06328e+06  -1.12281e+06  4.02861e+07  1.52694e+07  -1.78882e+09  2.49282e+09  4.94671e+10  5];
plot(x,y,'b');

% plot(dot_x,dot_y,'r--');
% 
% for i = 1:50
%     plot(dot_x(i), dot_y(i), 'r.','MarkerSize', 10);
% end

title('F = 5 Lagrange Interpolation uniform grid');
%legend({'y = 1/(1+25*x^2)', 'Ln(x)', 'y = 1/(1+25*x^2), grid', 'Uniform grid n = 50'}, 'Location', 'southeast');

xlim ([-1.1 1.1]);
ylim ([0 6]);

grid on;
hold off
