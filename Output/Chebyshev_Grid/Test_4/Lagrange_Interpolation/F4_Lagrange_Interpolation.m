% Интерполяция Лагранжем F4 Чебышевская сетка (n = 3)
dot_x=[-0.866025  6.12323e-17  0.866025];
dot_y=[3.3393  -2.1335  -0.869267];

x = [-1:0.01:1];
y = (4.*x.^3 + 2.*x.^2 - 4.*x + 2).^(sqrt(2)) + asin(1./(5 + x - x.^2)) - 5;
plot(x,y,'r');
hold on

x=[-1:0.01:1];
y=[4.78767  4.67399  4.56122  4.44934  4.33835  4.22827  4.11909  4.0108  3.90341  3.79692  3.69133  3.58664  3.48284  3.37995  3.27795  3.17685  3.07664  2.97734  2.87894  2.78143  2.68482  2.58911  2.4943  2.40038  2.30737  2.21525  2.12403  2.03371  1.94429  1.85576  1.76814  1.68141  1.59558  1.51065  1.42661  1.34348  1.26124  1.1799  1.09946  1.01992  0.941278  0.863533  0.786686  0.710737  0.635687  0.561535  0.488281  0.415925  0.344468  0.273909  0.204248  0.135485  0.0676211  0.000655063  -0.0654127  -0.130582  -0.194853  -0.258226  -0.320701  -0.382277  -0.442955  -0.502735  -0.561617  -0.6196  -0.676685  -0.732872  -0.78816  -0.842551  -0.896042  -0.948636  -1.00033  -1.05113  -1.10103  -1.15003  -1.19813  -1.24533  -1.29164  -1.33705  -1.38156  -1.42517  -1.46788  -1.5097  -1.55061  -1.59063  -1.62975  -1.66797  -1.70529  -1.74172  -1.77724  -1.81187  -1.8456  -1.87843  -1.91037  -1.9414  -1.97154  -2.00078  -2.02912  -2.05656  -2.08311  -2.10875  -2.1335  -2.15735  -2.1803  -2.20235  -2.2235  -2.24376  -2.26312  -2.28158  -2.29914  -2.3158  -2.33157  -2.34643  -2.3604  -2.37347  -2.38564  -2.39691  -2.40729  -2.41677  -2.42535  -2.43303  -2.43981  -2.44569  -2.45068  -2.45476  -2.45795  -2.46024  -2.46163  -2.46213  -2.46172  -2.46042  -2.45822  -2.45512  -2.45112  -2.44623  -2.44044  -2.43374  -2.42615  -2.41766  -2.40828  -2.39799  -2.38681  -2.37473  -2.36175  -2.34787  -2.33309  -2.31742  -2.30084  -2.28337  -2.265  -2.24573  -2.22557  -2.2045  -2.18254  -2.15968  -2.13592  -2.11126  -2.08571  -2.05925  -2.0319  -2.00365  -1.9745  -1.94445  -1.91351  -1.88166  -1.84892  -1.81528  -1.78074  -1.74531  -1.70897  -1.67174  -1.63361  -1.59458  -1.55465  -1.51382  -1.4721  -1.42947  -1.38595  -1.34153  -1.29622  -1.25  -1.20289  -1.15487  -1.10596  -1.05615  -1.00545  -0.95384  -0.901336  -0.847934  -0.793634  -0.738435  -0.682338  -0.625343  -0.567449  -0.508657  -0.448967  -0.388379  -0.326892  -0.264507  -0.201224  -0.137043  -0.0719628];
plot(x,y,'b');

% plot(dot_x,dot_y,'r--');

for i = 1:3
    plot(dot_x(i), dot_y(i), 'r.','MarkerSize', 10);
end


title('F4 Lagrange Interpolation Chebychev grid');
legend({'y = (4x^3 + 2x^2 - 4x + 2)^(sqrt(2)) + arcsin(1/(5 + x - x^2)) - 5', 'Ln(x)', 'Chebychev grid n = 3'}, 'Location', 'southeast');

%  xlim ([-1.1 1.1]);
%  ylim ([-0.1 1.1]);

grid on;
hold off

% Интерполяция Лагранжем F4 Чебышевская сетка (n = 10)
figure;
dot_x = [-0.987688  -0.891007  -0.707107  -0.45399  -0.156434  0.156434  0.45399  0.707107  0.891007  0.987688];
dot_y = [2.55873  3.23225  3.43188  1.97138  -0.803227  -3.13154  -3.84969  -2.88725  -0.397591  1.94093];

x = [-1:0.01:1];
y = (4.*x.^3 + 2.*x.^2 - 4.*x + 2).^(sqrt(2)) + asin(1./(5 + x - x.^2)) - 5;
plot(x,y,'r');
hold on

x=[-1:0.01:1];
y=[2.44395  2.53767  2.62716  2.71239  2.79331  2.86987  2.94206  3.00986  3.07325  3.13226  3.18687  3.23711  3.283  3.32456  3.36183  3.39483  3.42362  3.44824  3.46873  3.48516  3.49756  3.506  3.51054  3.51125  3.50818  3.5014  3.49098  3.47698  3.45949  3.43857  3.41428  3.38672  3.35594  3.32203  3.28505  3.24509  3.20222  3.15652  3.10806  3.05693  3.00319  2.94693  2.88822  2.82715  2.76379  2.69821  2.6305  2.56074  2.48899  2.41535  2.33988  2.26267  2.18379  2.10333  2.02134  1.93793  1.85316  1.7671  1.67984  1.59145  1.50201  1.4116  1.32028  1.22813  1.13524  1.04167  0.947491  0.852786  0.757624  0.662078  0.56622  0.470119  0.373848  0.277475  0.18107  0.084701  -0.0115646  -0.10766  -0.20352  -0.29908  -0.394275  -0.489044  -0.583325  -0.677057  -0.770181  -0.86264  -0.954376  -1.04533  -1.13546  -1.2247  -1.31301  -1.40033  -1.48661  -1.57182  -1.65589  -1.7388  -1.8205  -1.90094  -1.9801  -2.05792  -2.13438  -2.20944  -2.28307  -2.35525  -2.42593  -2.49509  -2.56272  -2.62877  -2.69324  -2.7561  -2.81733  -2.87691  -2.93483  -2.99106  -3.04561  -3.09845  -3.14957  -3.19897  -3.24663  -3.29254  -3.3367  -3.3791  -3.41973  -3.4586  -3.49568  -3.53099  -3.5645  -3.59623  -3.62615  -3.65428  -3.68059  -3.70509  -3.72777  -3.74862  -3.76763  -3.78479  -3.80009  -3.81352  -3.82506  -3.83469  -3.84239  -3.84815  -3.85194  -3.85373  -3.85349  -3.85119  -3.84679  -3.84026  -3.83155  -3.82062  -3.8074  -3.79186  -3.77392  -3.75353  -3.73062  -3.70511  -3.67692  -3.64597  -3.61217  -3.57543  -3.53565  -3.49272  -3.44654  -3.39698  -3.34392  -3.28724  -3.22681  -3.16248  -3.09411  -3.02155  -2.94464  -2.86322  -2.77714  -2.6862  -2.59025  -2.48909  -2.38255  -2.27043  -2.15255  -2.0287  -1.89869  -1.76231  -1.61936  -1.46964  -1.31294  -1.14906  -0.977791  -0.79893  -0.612277  -0.417633  -0.214805  -0.00360449  0.216151  0.444637  0.682019  0.928453  1.18409  1.44905  1.72346  2.00742  2.30102];
plot(x,y,'b');

% plot(dot_x,dot_y,'r--');

for i = 1:10
    plot(dot_x(i), dot_y(i), 'r.','MarkerSize', 10);
end

title('F4 Lagrange Interpolation Chebychev grid');
legend({'y = (4x^3 + 2x^2 - 4x + 2)^(sqrt(2)) + arcsin(1/(5 + x - x^2)) - 5', 'Ln(x)', 'Chebychev grid n = 10'}, 'Location', 'southeast');

%  xlim ([-1.1 1.1]);
%  ylim ([-0.7 1.1]);

grid on;
hold off

% Интерполяция Лагранжем F4 Чебышевская сетка (n = 50)
figure;
dot_x=[-0.999507  -0.995562  -0.987688  -0.975917  -0.960294  -0.940881  -0.917755  -0.891007  -0.860742  -0.827081  -0.790155  -0.750111  -0.707107  -0.661312  -0.612907  -0.562083  -0.509041  -0.45399  -0.397148  -0.338738  -0.278991  -0.218143  -0.156434  -0.0941083  -0.0314108  0.0314108  0.0941083  0.156434  0.218143  0.278991  0.338738  0.397148  0.45399  0.509041  0.562083  0.612907  0.661312  0.707107  0.750111  0.790155  0.827081  0.860742  0.891007  0.917755  0.940881  0.960294  0.975917  0.987688  0.995562  0.999507];
dot_y=[2.44761  2.4854  2.55873  2.66315  2.79207  2.93697  3.08756  3.23225  3.35852  3.45352  3.50476  3.50078  3.43188  3.2908  3.07325  2.77837  2.40894  1.97138  1.47558  0.934379  0.362963  -0.221987  -0.803227  -1.36395  -1.88877  -2.36454  -2.78109  -3.13154  -3.41237  -3.62295  -3.76469  -3.83974  -3.84969  -3.79461  -3.67292  -3.48214  -3.22028  -2.88725  -2.48607  -2.02363  -1.51091  -0.962815  -0.397591  0.164076  0.700161  1.18854  1.6083  1.94093  2.17149  2.28947];

x = [-1:0.01:1];
y = (4.*x.^3 + 2.*x.^2 - 4.*x + 2).^(sqrt(2)) + asin(1./(5 + x - x.^2)) - 5;
plot(x,y,'r');
hold on

x=[-1:0.01:1];
y=[2.44283  2.53749  2.62764  2.71327  2.79439  2.87101  2.94314  3.01079  3.07399  3.13275  3.18711  3.23709  3.28273  3.32406  3.36112  3.39396  3.42261  3.44713  3.46757  3.48396  3.49638  3.50486  3.50947  3.51028  3.50733  3.50069  3.49042  3.47659  3.45927  3.43852  3.41441  3.38701  3.35639  3.32263  3.28579  3.24596  3.2032  3.15759  3.10921  3.05813  3.00443  2.94818  2.88947  2.82838  2.76497  2.69934  2.63156  2.5617  2.48986  2.4161  2.34051  2.26317  2.18416  2.10355  2.02143  1.93787  1.85296  1.76677  1.67937  1.59086  1.5013  1.41078  1.31936  1.22713  1.13416  1.04053  0.946309  0.851571  0.756391  0.66084  0.56499  0.468913  0.372678  0.276354  0.18001  0.0837124  -0.0124714  -0.108476  -0.204238  -0.299693  -0.394779  -0.489434  -0.583599  -0.677214  -0.770222  -0.862566  -0.954191  -1.04504  -1.13507  -1.22421  -1.31243  -1.39967  -1.48589  -1.57104  -1.65507  -1.73794  -1.81961  -1.90004  -1.97919  -2.05702  -2.1335  -2.20859  -2.28226  -2.35447  -2.42521  -2.49443  -2.56212  -2.62824  -2.69278  -2.75571  -2.81701  -2.87666  -2.93464  -2.99094  -3.04554  -3.09842  -3.14959  -3.19901  -3.24669  -3.29261  -3.33677  -3.37916  -3.41978  -3.45861  -3.49565  -3.5309  -3.56436  -3.59602  -3.62588  -3.65394  -3.68018  -3.70461  -3.72723  -3.74802  -3.76698  -3.7841  -3.79938  -3.8128  -3.82434  -3.834  -3.84175  -3.84758  -3.85146  -3.85336  -3.85326  -3.85112  -3.8469  -3.84056  -3.83206  -3.82134  -3.80835  -3.79304  -3.77533  -3.75515  -3.73245  -3.70712  -3.6791  -3.64829  -3.6146  -3.57793  -3.53818  -3.49524  -3.44899  -3.39933  -3.34611  -3.28923  -3.22853  -3.1639  -3.09519  -3.02225  -2.94494  -2.8631  -2.77657  -2.68519  -2.5888  -2.48723  -2.3803  -2.26784  -2.14967  -2.0256  -1.89544  -1.75901  -1.61611  -1.46654  -1.3101  -1.14658  -0.975785  -0.797491  -0.611489  -0.417558  -0.21548  -0.00502922  0.214022  0.441903  0.678849  0.925096  1.18088  1.44646  1.72206  2.00794  2.30435];
plot(x,y,'b');

% plot(dot_x,dot_y,'r--');

for i = 1:50
    plot(dot_x(i), dot_y(i), 'r.','MarkerSize', 10);
end

title('F4 Lagrange Interpolation Chebychev grid');
legend({'y = (4x^3 + 2x^2 - 4x + 2)^(sqrt(2)) + arcsin(1/(5 + x - x^2)) - 5', 'Ln(x)', 'Chebychev grid n = 50'}, 'Location', 'southeast');

% xlim ([-3.1 3.1]);
% ylim ([-6 2]);

grid on;
hold off
