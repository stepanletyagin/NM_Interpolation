% Интерполяция сплайнами F4 Чебышевская сетка (n = 3)
dot_x=[-0.866025  6.12323e-17  0.866025];
dot_y=[3.3393  -2.1335  -0.869267];

x = [-1:0.01:1];
y = (4.*x.^3 + 2.*x.^2 - 4.*x + 2).^(sqrt(2)) + asin(1./(5 + x - x.^2)) - 5;
plot(x,y,'r');
hold on

x=[-1:0.01:0.86];
y=[4.44026  4.35891  4.27737  4.19566  4.11378  4.03175  3.94959  3.86732  3.78495  3.70249  3.61997  3.53739  3.45478  3.37214  3.2895  3.20687  3.12426  3.0417  2.95919  2.87675  2.79439  2.71214  2.63001  2.54802  2.46617  2.38448  2.30298  2.22168  2.14058  2.05971  1.97909  1.89872  1.81863  1.73883  1.65933  1.58015  1.50131  1.42282  1.3447  1.26696  1.18962  1.11269  1.03619  0.960136  0.884544  0.809427  0.734803  0.660685  0.58709  0.514034  0.441531  0.369598  0.29825  0.227503  0.157372  0.0878725  0.0190203  -0.049169  -0.11668  -0.183497  -0.249605  -0.314987  -0.379629  -0.443514  -0.506628  -0.568955  -0.630479  -0.691184  -0.751055  -0.810077  -0.868234  -0.92551  -0.98189  -1.03736  -1.0919  -1.1455  -1.19814  -1.2498  -1.30048  -1.35015  -1.3988  -1.44641  -1.49297  -1.53847  -1.58288  -1.62619  -1.66839  -1.70946  -1.74939  -1.78815  -1.82574  -1.86213  -1.89732  -1.93129  -1.96402  -1.99549  -2.02569  -2.05461  -2.08223  -2.10853  -2.1335  -2.15712  -2.17942  -2.2004  -2.22008  -2.23847  -2.25559  -2.27146  -2.28609  -2.2995  -2.3117  -2.32271  -2.33254  -2.34122  -2.34874  -2.35514  -2.36042  -2.36461  -2.36771  -2.36974  -2.37072  -2.37067  -2.3696  -2.36752  -2.36445  -2.3604  -2.3554  -2.34946  -2.34259  -2.3348  -2.32612  -2.31656  -2.30614  -2.29486  -2.28275  -2.26983  -2.2561  -2.24158  -2.22629  -2.21024  -2.19346  -2.17595  -2.15773  -2.13881  -2.11922  -2.09896  -2.07806  -2.05652  -2.03437  -2.01162  -1.98828  -1.96438  -1.93992  -1.91492  -1.8894  -1.86337  -1.83685  -1.80985  -1.7824  -1.7545  -1.72616  -1.69742  -1.66828  -1.63875  -1.60886  -1.57861  -1.54803  -1.51713  -1.48592  -1.45442  -1.42265  -1.39062  -1.35835  -1.32586  -1.29315  -1.26024  -1.22715  -1.1939  -1.1605  -1.12697  -1.09331  -1.05956  -1.02571  -0.991799  -0.957828  -0.923817  -0.889781];
plot(x,y,'b');

% plot(dot_x,dot_y,'r--');

for i = 1:3
    plot(dot_x(i), dot_y(i), 'r.','MarkerSize', 10);
end


title('F4 Spline Interpolation Chebychev grid');
legend({'y = (4x^3 + 2x^2 - 4x + 2)^(sqrt(2)) + arcsin(1/(5 + x - x^2)) - 5', 'Spline', 'Chebychev grid n = 3'}, 'Location', 'southeast');

%  xlim ([-3.1 3.1]);
%  ylim ([-0.1 3.1]);

grid on;
hold off

% Интерполяция сплайнами F4 Чебышевская сетка (n = 10)
figure;
dot_x = [-0.987688  -0.891007  -0.707107  -0.45399  -0.156434  0.156434  0.45399  0.707107  0.891007  0.987688];
dot_y = [2.55873  3.23225  3.43188  1.97138  -0.803227  -3.13154  -3.84969  -2.88725  -0.397591  1.94093];

x = [-1:0.01:1];
y = (4.*x.^3 + 2.*x.^2 - 4.*x + 2).^(sqrt(2)) + asin(1./(5 + x - x.^2)) - 5;
plot(x,y,'r');
hold on

x=[-1:0.01:0.98];
y=[2.46245  2.54062  2.61892  2.6968  2.77368  2.84903  2.92227  2.99286  3.06023  3.12383  3.18311  3.23749  3.28659  3.33045  3.36924  3.40307  3.43211  3.4565  3.47637  3.49188  3.50316  3.51036  3.51362  3.51309  3.50891  3.50122  3.49017  3.4759  3.45855  3.43828  3.41091  3.37908  3.34459  3.3075  3.26785  3.22571  3.18112  3.13413  3.08481  3.03319  2.97934  2.9233  2.86513  2.80488  2.74261  2.67836  2.61219  2.54415  2.47429  2.40267  2.32934  2.25435  2.17775  2.0996  2.01995  1.93802  1.85344  1.76755  1.68042  1.59214  1.50277  1.4124  1.32109  1.22892  1.13597  1.04232  0.948038  0.853202  0.757887  0.662171  0.566127  0.469833  0.373363  0.276793  0.1802  0.083659  -0.0127545  -0.108965  -0.204896  -0.300472  -0.395617  -0.490256  -0.584313  -0.677713  -0.770378  -0.862493  -0.953894  -1.04441  -1.13401  -1.22267  -1.31035  -1.39702  -1.48266  -1.56724  -1.65072  -1.73307  -1.81428  -1.89429  -1.9731  -2.05065  -2.12694  -2.20192  -2.27557  -2.34785  -2.41874  -2.48821  -2.55622  -2.62275  -2.68776  -2.75123  -2.81313  -2.87343  -2.93209  -2.98909  -3.0444  -3.09799  -3.14988  -3.20012  -3.24857  -3.29523  -3.34009  -3.38314  -3.42437  -3.46378  -3.50135  -3.53708  -3.57096  -3.60298  -3.63313  -3.6614  -3.68778  -3.71227  -3.73486  -3.75554  -3.77429  -3.79112  -3.80601  -3.81895  -3.82994  -3.83897  -3.84602  -3.8511  -3.85418  -3.85527  -3.85435  -3.85142  -3.84713  -3.84122  -3.83314  -3.82283  -3.81019  -3.79515  -3.77763  -3.75754  -3.7348  -3.70933  -3.68104  -3.64987  -3.61571  -3.5785  -3.53815  -3.49457  -3.4477  -3.39743  -3.3437  -3.28642  -3.22551  -3.16088  -3.09246  -3.02016  -2.9439  -2.86409  -2.78127  -2.69393  -2.60175  -2.50442  -2.40159  -2.29296  -2.1782  -2.05698  -1.92898  -1.79388  -1.65135  -1.50108  -1.34274  -1.176  -1.00054  -0.816041  -0.622178  -0.418628  -0.205232  0.0172722  0.247847  0.485453  0.729052  0.977605  1.23007  1.48542  1.7426];
plot(x,y,'b');

% plot(dot_x,dot_y,'r--');

for i = 1:10
    plot(dot_x(i), dot_y(i), 'r.','MarkerSize', 10);
end

title('F4 Spline Interpolation Chebychev grid');
legend({'y = (4x^3 + 2x^2 - 4x + 2)^(sqrt(2)) + arcsin(1/(5 + x - x^2)) - 5', 'Spline', 'Chebychev grid n = 10'}, 'Location', 'southeast');

%  xlim ([-1.1 1.1]);
%  ylim ([-0.1 1.1]);

grid on;
hold off

% Интерполяция сплайнами F4 Чебышевская сетка (n = 50)
figure;
dot_x=[-0.999507  -0.995562  -0.987688  -0.975917  -0.960294  -0.940881  -0.917755  -0.891007  -0.860742  -0.827081  -0.790155  -0.750111  -0.707107  -0.661312  -0.612907  -0.562083  -0.509041  -0.45399  -0.397148  -0.338738  -0.278991  -0.218143  -0.156434  -0.0941083  -0.0314108  0.0314108  0.0941083  0.156434  0.218143  0.278991  0.338738  0.397148  0.45399  0.509041  0.562083  0.612907  0.661312  0.707107  0.750111  0.790155  0.827081  0.860742  0.891007  0.917755  0.940881  0.960294  0.975917  0.987688  0.995562  0.999507];
dot_y=[2.44761  2.4854  2.55873  2.66315  2.79207  2.93697  3.08756  3.23225  3.35852  3.45352  3.50476  3.50078  3.43188  3.2908  3.07325  2.77837  2.40894  1.97138  1.47558  0.934379  0.362963  -0.221987  -0.803227  -1.36395  -1.88877  -2.36454  -2.78109  -3.13154  -3.41237  -3.62295  -3.76469  -3.83974  -3.84969  -3.79461  -3.67292  -3.48214  -3.22028  -2.88725  -2.48607  -2.02363  -1.51091  -0.962815  -0.397591  0.164076  0.700161  1.18854  1.6083  1.94093  2.17149  2.28947];

x = [-1:0.01:1];
y = (4.*x.^3 + 2.*x.^2 - 4.*x + 2).^(sqrt(2)) + asin(1./(5 + x - x.^2)) - 5;
plot(x,y,'r');
hold on

x=[-1:0.01:0.99];
y=[2.44286  2.53749  2.62759  2.71324  2.79439  2.87094  2.94313  3.01072  3.07396  3.13268  3.18703  3.23708  3.28264  3.32398  3.36111  3.39388  3.42253  3.44711  3.46751  3.48387  3.4963  3.50486  3.5094  3.51018  3.50726  3.50068  3.49035  3.4765  3.45919  3.43849  3.41436  3.38693  3.35631  3.32258  3.28579  3.2459  3.20312  3.15752  3.10917  3.05811  3.00437  2.94812  2.88941  2.82834  2.76496  2.6993  2.6315  2.56165  2.48982  2.4161  2.34049  2.26314  2.18412  2.10352  2.02141  1.93786  1.85294  1.76674  1.67935  1.59084  1.5013  1.41077  1.31935  1.22711  1.13415  1.04052  0.946307  0.851566  0.756383  0.660831  0.564983  0.468908  0.372677  0.276353  0.180009  0.0837119  -0.0124719  -0.108477  -0.204238  -0.299692  -0.394775  -0.489429  -0.583594  -0.677212  -0.770222  -0.862564  -0.954186  -1.04503  -1.13506  -1.22421  -1.31243  -1.39967  -1.48589  -1.57103  -1.65506  -1.73793  -1.81961  -1.90004  -1.97919  -2.05701  -2.13349  -2.20858  -2.28226  -2.35447  -2.42521  -2.49443  -2.56212  -2.62824  -2.69278  -2.75571  -2.81701  -2.87666  -2.93464  -2.99094  -3.04554  -3.09843  -3.14959  -3.19902  -3.2467  -3.29262  -3.33678  -3.37917  -3.41978  -3.45862  -3.49567  -3.53092  -3.56438  -3.59603  -3.62588  -3.65395  -3.68021  -3.70464  -3.72725  -3.74803  -3.76698  -3.78413  -3.79941  -3.81283  -3.82437  -3.83401  -3.84176  -3.84761  -3.8515  -3.85341  -3.85329  -3.85113  -3.84692  -3.8406  -3.83211  -3.82139  -3.80838  -3.79304  -3.77536  -3.75521  -3.7325  -3.70716  -3.67911  -3.64832  -3.61466  -3.578  -3.53823  -3.49525  -3.44903  -3.39939  -3.34619  -3.28928  -3.22854  -3.16396  -3.09528  -3.02234  -2.94499  -2.86312  -2.77665  -2.6853  -2.58888  -2.48723  -2.38039  -2.26796  -2.14976  -2.0256  -1.89554  -1.75914  -1.61619  -1.46658  -1.31023  -1.14671  -0.975798  -0.797614  -0.611626  -0.417578  -0.21561  -0.00515293  0.213973  0.44176  0.678827  0.924966  1.18088  1.44634  1.72198  2.00787];
plot(x,y,'b');

% plot(dot_x,dot_y,'r--');

for i = 1:50
    plot(dot_x(i), dot_y(i), 'r.','MarkerSize', 10);
end

title('F4 Spline Interpolation Chebychev grid');
legend({'y = (4x^3 + 2x^2 - 4x + 2)^(sqrt(2)) + arcsin(1/(5 + x - x^2)) - 5', 'Spline', 'Chebychev grid n = 50'}, 'Location', 'southeast');

%   xlim ([-3.1 3.1]);
%   ylim ([-0.1 1.1]);

grid on;
hold off
