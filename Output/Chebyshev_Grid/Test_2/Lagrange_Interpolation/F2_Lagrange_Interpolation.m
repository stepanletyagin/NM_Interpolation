% Интерполяция Лагранжем F2 Чебышевская сетка (n = 3)
dot_x=[-0.866025  6.12323e-17  0.866025];
dot_y=[0.0506329  1  0.0506329];

x = [-1:0.01:1];
y = 1./(1+25.*x.^2);
plot(x,y,'r');
hold on

x=[-1:0.01:1];
y=[-0.265823  -0.240633  -0.215696  -0.191013  -0.166582  -0.142405  -0.118481  -0.0948101  -0.0713924  -0.0482278  -0.0253165  -0.00265823  0.0197468  0.0418987  0.0637975  0.085443  0.106835  0.127975  0.148861  0.169494  0.189873  0.21  0.229873  0.249494  0.268861  0.287975  0.306835  0.325443  0.343797  0.361899  0.379747  0.397342  0.414684  0.431772  0.448608  0.46519  0.481519  0.497595  0.513418  0.528987  0.544304  0.559367  0.574177  0.588734  0.603038  0.617089  0.630886  0.64443  0.657722  0.670759  0.683544  0.696076  0.708354  0.72038  0.732152  0.743671  0.754937  0.765949  0.776709  0.787215  0.797468  0.807468  0.817215  0.826709  0.835949  0.844937  0.853671  0.862152  0.87038  0.878354  0.886076  0.893544  0.900759  0.907722  0.91443  0.920886  0.927089  0.933038  0.938734  0.944177  0.949367  0.954304  0.958987  0.963418  0.967595  0.971519  0.97519  0.978608  0.981772  0.984684  0.987342  0.989747  0.991899  0.993797  0.995443  0.996835  0.997975  0.998861  0.999494  0.999873  1  0.999873  0.999494  0.998861  0.997975  0.996835  0.995443  0.993797  0.991899  0.989747  0.987342  0.984684  0.981772  0.978608  0.97519  0.971519  0.967595  0.963418  0.958987  0.954304  0.949367  0.944177  0.938734  0.933038  0.927089  0.920886  0.91443  0.907722  0.900759  0.893544  0.886076  0.878354  0.87038  0.862152  0.853671  0.844937  0.835949  0.826709  0.817215  0.807468  0.797468  0.787215  0.776709  0.765949  0.754937  0.743671  0.732152  0.72038  0.708354  0.696076  0.683544  0.670759  0.657722  0.64443  0.630886  0.617089  0.603038  0.588734  0.574177  0.559367  0.544304  0.528987  0.513418  0.497595  0.481519  0.46519  0.448608  0.431772  0.414684  0.397342  0.379747  0.361899  0.343797  0.325443  0.306835  0.287975  0.268861  0.249494  0.229873  0.21  0.189873  0.169494  0.148861  0.127975  0.106835  0.085443  0.0637975  0.0418987  0.0197468  -0.00265823  -0.0253165  -0.0482278  -0.0713924  -0.0948101  -0.118481  -0.142405  -0.166582  -0.191013  -0.215696  -0.240633  -0.265823];
plot(x,y,'b');

plot(dot_x,dot_y,'r--');

for i = 1:3
    plot(dot_x(i), dot_y(i), 'r.','MarkerSize', 10);
end


title('F2 Lagrange Interpolation Chebyshev grid');
legend({'y = 1/(1+25*x^2)', 'Ln(x)', 'y = 1/(1+25*x^2), grid', 'Chebyshev grid n = 3'}, 'Location', 'southeast');

xlim ([-1.1 1.1]);
ylim ([-0.1 1.1]);

grid on;
hold off

% Интерполяция Лагранжем F2 Чебышевская сетка (n = 10)
figure;
dot_x = [-0.987688  -0.891007  -0.707107  -0.45399  -0.156434  0.156434  0.45399  0.707107  0.891007  0.987688];
dot_y = [0.0393884  0.0479678  0.0740741  0.162531  0.620427  0.620427  0.162531  0.0740741  0.0479678  0.0393884];

x = [-1:0.01:1];
y = 1./(1+25.*x.^2);
plot(x,y,'r');
hold on

x=[-1:0.01:1];
y=[0.0488146  0.0408455  0.0354723  0.0322848  0.0309125  0.0310229  0.0323186  0.0345352  0.0374391  0.0408254  0.0445159  0.0483574  0.0522194  0.0559929  0.0595881  0.0629336  0.065974  0.068669  0.070992  0.0729286  0.0744754  0.0756388  0.0764339  0.0768835  0.0770171  0.0768699  0.0764818  0.0758968  0.0751619  0.074327  0.0734434  0.0725637  0.0717411  0.0710287  0.0704794  0.0701448  0.0700755  0.0703201  0.0709253  0.0719353  0.0733918  0.0753334  0.0777958  0.0808112  0.0844084  0.0886128  0.093446  0.0989259  0.105066  0.111878  0.119367  0.127536  0.136384  0.145906  0.156093  0.166934  0.178412  0.190509  0.203203  0.216467  0.230274  0.244593  0.259389  0.274626  0.290266  0.306267  0.322587  0.339182  0.356005  0.373009  0.390146  0.407365  0.424616  0.441849  0.459012  0.476055  0.492925  0.509571  0.525943  0.541991  0.557665  0.572918  0.587702  0.601971  0.615682  0.628791  0.641257  0.653042  0.664109  0.674424  0.683953  0.692668  0.70054  0.707546  0.713663  0.718871  0.723155  0.726501  0.728899  0.730341  0.730822  0.730341  0.728899  0.726501  0.723155  0.718871  0.713663  0.707546  0.70054  0.692668  0.683953  0.674424  0.664109  0.653042  0.641257  0.628791  0.615682  0.601971  0.587702  0.572918  0.557665  0.541991  0.525943  0.509571  0.492925  0.476055  0.459012  0.441849  0.424616  0.407365  0.390146  0.373009  0.356005  0.339182  0.322587  0.306267  0.290266  0.274626  0.259389  0.244593  0.230274  0.216467  0.203203  0.190509  0.178412  0.166934  0.156093  0.145906  0.136384  0.127536  0.119367  0.111878  0.105066  0.0989259  0.093446  0.0886128  0.0844084  0.0808112  0.0777958  0.0753334  0.0733918  0.0719353  0.0709253  0.0703201  0.0700755  0.0701448  0.0704794  0.0710287  0.0717411  0.0725637  0.0734434  0.074327  0.0751619  0.0758968  0.0764818  0.0768699  0.0770171  0.0768835  0.0764339  0.0756388  0.0744754  0.0729286  0.070992  0.068669  0.065974  0.0629336  0.0595881  0.0559929  0.0522194  0.0483574  0.0445159  0.0408254  0.0374391  0.0345352  0.0323186  0.0310229  0.0309125  0.0322848  0.0354723  0.0408455  0.0488146];
plot(x,y,'b');

plot(dot_x,dot_y,'r--');

for i = 1:10
    plot(dot_x(i), dot_y(i), 'r.','MarkerSize', 10);
end

title('F2 Lagrange Interpolation Chebyshev grid');
legend({'y = 1/(1+25*x^2)', 'Ln(x)', 'y = 1/(1+25*x^2), grid', 'Chebyshev grid n = 10'}, 'Location', 'southeast');

xlim ([-1.1 1.1]);
ylim ([-0.1 1.1]);

grid on;
hold off

% Интерполяция Лагранжем F2 Чебышевская сетка (n = 50)
figure;
dot_x=[-0.999507  -0.995562  -0.987688  -0.975917  -0.960294  -0.940881  -0.917755  -0.891007  -0.860742  -0.827081  -0.790155  -0.750111  -0.707107  -0.661312  -0.612907  -0.562083  -0.509041  -0.45399  -0.397148  -0.338738  -0.278991  -0.218143  -0.156434  -0.0941083  -0.0314108  0.0314108  0.0941083  0.156434  0.218143  0.278991  0.338738  0.397148  0.45399  0.509041  0.562083  0.612907  0.661312  0.707107  0.750111  0.790155  0.827081  0.860742  0.891007  0.917755  0.940881  0.960294  0.975917  0.987688  0.995562  0.999507];
dot_y=[0.0384981  0.0387919  0.0393884  0.0403058  0.041573  0.0432312  0.0453374  0.0479678  0.0512245  0.0552439  0.0602097  0.0663717  0.0740741  0.0837989  0.0962336  0.112379  0.133724  0.162531  0.2023  0.258492  0.339455  0.456692  0.620427  0.818726  0.975928  0.975928  0.818726  0.620427  0.456692  0.339455  0.258492  0.2023  0.162531  0.133724  0.112379  0.0962336  0.0837989  0.0740741  0.0663717  0.0602097  0.0552439  0.0512245  0.0479678  0.0453374  0.0432312  0.041573  0.0403058  0.0393884  0.0387919  0.0384981];

x = [-1:0.01:1];
y = 1./(1+25.*x.^2);
plot(x,y,'r');
hold on

x=[-1:0.01:1];
y=[0.0384653  0.0392145  0.0399808  0.0407827  0.0415971  0.0424363  0.0433093  0.0442081  0.0451276  0.046074  0.047055  0.0480717  0.0491203  0.0501984  0.051308  0.0524546  0.0536433  0.0548758  0.0561514  0.0574686  0.0588277  0.0602318  0.0616859  0.063195  0.0647625  0.0663901  0.0680781  0.069827  0.0716388  0.0735173  0.0754682  0.0774974  0.0796105  0.081812  0.084105  0.0864922  0.0889765  0.091562  0.0942547  0.0970621  0.099993  0.103056  0.106261  0.109614  0.113124  0.116796  0.120639  0.124661  0.128873  0.13329  0.137924  0.142794  0.147915  0.153304  0.158977  0.164952  0.171245  0.177874  0.18486  0.192227  0.200003  0.208217  0.216903  0.226095  0.235828  0.24614  0.257068  0.268648  0.280922  0.29393  0.307719  0.322338  0.33784  0.35428  0.371717  0.390206  0.4098  0.430547  0.452485  0.475643  0.500039  0.525675  0.552536  0.580587  0.609767  0.63998  0.671093  0.702921  0.735225  0.767701  0.799977  0.831617  0.862123  0.890949  0.917519  0.94125  0.961577  0.977988  0.990047  0.997421  0.999903  0.997421  0.990047  0.977988  0.961577  0.94125  0.917519  0.890949  0.862123  0.831617  0.799977  0.767701  0.735225  0.702921  0.671093  0.63998  0.609767  0.580587  0.552536  0.525675  0.500039  0.475643  0.452485  0.430547  0.4098  0.390206  0.371717  0.35428  0.33784  0.322338  0.307719  0.29393  0.280922  0.268648  0.257068  0.24614  0.235828  0.226095  0.216903  0.208217  0.200003  0.192227  0.18486  0.177874  0.171245  0.164952  0.158977  0.153304  0.147915  0.142794  0.137924  0.13329  0.128873  0.124661  0.120639  0.116796  0.113124  0.109614  0.106261  0.103056  0.099993  0.0970621  0.0942547  0.091562  0.0889765  0.0864922  0.084105  0.081812  0.0796105  0.0774974  0.0754682  0.0735173  0.0716388  0.069827  0.0680781  0.0663901  0.0647625  0.063195  0.0616859  0.0602318  0.0588277  0.0574686  0.0561514  0.0548758  0.0536433  0.0524546  0.051308  0.0501984  0.0491203  0.0480717  0.047055  0.046074  0.0451276  0.0442081  0.0433093  0.0424363  0.0415971  0.0407827  0.0399808  0.0392145  0.0384653];
plot(x,y,'b');

plot(dot_x,dot_y,'r--');

for i = 1:50
    plot(dot_x(i), dot_y(i), 'r.','MarkerSize', 10);
end

title('F2 Lagrange Interpolation Chebyshev grid');
legend({'y = 1/(1+25*x^2)', 'Ln(x)', 'y = 1/(1+25*x^2), grid', 'Chebyshev grid n = 50'}, 'Location', 'southeast');

xlim ([-1.1 1.1]);
ylim ([-0.1 1.5]);

grid on;
hold off
