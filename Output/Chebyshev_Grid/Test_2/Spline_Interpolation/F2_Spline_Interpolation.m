% Интерполяция сплайнами F2 Чебышевская сетка (n = 3)
dot_x=[-0.866025  6.12323e-17  0.866025];
dot_y=[0.0506329  1  0.0506329];

x = [-1:0.01:1];
y = 1./(1+25.*x.^2);
plot(x,y,'r');
hold on

x=[-1:0.01:0.86];
y=[-0.167911  -0.151832  -0.135699  -0.119516  -0.103288  -0.0870181  -0.0707115  -0.0543725  -0.0380054  -0.0216147  -0.00520463  0.0112203  0.0276558  0.0440973  0.0605406  0.0769813  0.093415  0.109837  0.126244  0.14263  0.158992  0.175324  0.191624  0.207885  0.224105  0.240278  0.2564  0.272467  0.288474  0.304418  0.320293  0.336095  0.351819  0.367463  0.38302  0.398487  0.413859  0.429133  0.444302  0.459364  0.474313  0.489146  0.503858  0.518445  0.532901  0.547224  0.561407  0.575448  0.589342  0.603084  0.616669  0.630095  0.643355  0.656446  0.669363  0.682103  0.69466  0.70703  0.719209  0.731192  0.742975  0.754554  0.765925  0.777082  0.788021  0.798739  0.809231  0.819491  0.829517  0.839304  0.848846  0.858141  0.867182  0.875967  0.884491  0.892748  0.900736  0.908449  0.915883  0.923034  0.929897  0.936468  0.942743  0.948717  0.954386  0.959745  0.96479  0.969517  0.973921  0.977998  0.981743  0.985153  0.988222  0.990947  0.993322  0.995345  0.997009  0.998311  0.999246  0.999811  1  0.999811  0.999246  0.998311  0.997009  0.995345  0.993322  0.990947  0.988222  0.985153  0.981743  0.977998  0.973921  0.969517  0.96479  0.959745  0.954386  0.948717  0.942743  0.936468  0.929897  0.923034  0.915883  0.908449  0.900736  0.892748  0.884491  0.875967  0.867182  0.858141  0.848846  0.839304  0.829517  0.819491  0.809231  0.798739  0.788021  0.777082  0.765925  0.754554  0.742975  0.731192  0.719209  0.70703  0.69466  0.682103  0.669363  0.656446  0.643355  0.630095  0.616669  0.603084  0.589342  0.575448  0.561407  0.547224  0.532901  0.518445  0.503858  0.489146  0.474313  0.459364  0.444302  0.429133  0.413859  0.398487  0.38302  0.367463  0.351819  0.336095  0.320293  0.304418  0.288474  0.272467  0.2564  0.240278  0.224105  0.207885  0.191624  0.175324  0.158992  0.14263  0.126244  0.109837  0.093415  0.0769813  0.0605406];
plot(x,y,'b');

plot(dot_x,dot_y,'r--');

for i = 1:3
    plot(dot_x(i), dot_y(i), 'r.','MarkerSize', 10);
end


title('F2 Spline Interpolation Chebyshev grid');
legend({'y = 1/(1+25*x^2)', 'Spline', 'y = 1/(1+25*x^2), grid', 'Chebyshev grid n = 3'}, 'Location', 'southeast');

%  xlim ([-1.1 1.1]);
 ylim ([-0.1 1.1]);

grid on;
hold off

% Интерполяция сплайнами F2 Чебышевская сетка (n = 10)
figure;
dot_x = [-0.987688  -0.891007  -0.707107  -0.45399  -0.156434  0.156434  0.45399  0.707107  0.891007  0.987688];
dot_y = [0.0393884  0.0479678  0.0740741  0.162531  0.620427  0.620427  0.162531  0.0740741  0.0479678  0.0393884];

x = [-1:0.01:1];
y = 1./(1+25.*x.^2);
plot(x,y,'r');
hold on

x=[-1:0.01:0.98];
y=[0.0384962  0.0392214  0.0399443  0.0406752  0.041425  0.0422042  0.0430233  0.0438931  0.0448242  0.0458271  0.0469125  0.0480909  0.0493678  0.0507329  0.0521729  0.0536748  0.0552252  0.0568111  0.0584194  0.0600367  0.06165  0.0632461  0.0648117  0.0663338  0.0677992  0.0691947  0.0705071  0.0717232  0.0728299  0.0738141  0.074675  0.0754293  0.0761141  0.0767703  0.0774387  0.0781603  0.078976  0.0799268  0.0810535  0.082397  0.0839984  0.0858985  0.0881382  0.0907584  0.0938002  0.0973043  0.101312  0.105863  0.111  0.116763  0.123193  0.130331  0.138217  0.146894  0.156401  0.166758  0.177955  0.18997  0.202744  0.216222  0.230347  0.245062  0.260311  0.276036  0.292182  0.308692  0.325508  0.342575  0.359836  0.377233  0.394711  0.412212  0.42968  0.447059  0.464291  0.48132  0.49809  0.514543  0.530623  0.546274  0.561438  0.57606  0.590081  0.603446  0.616099  0.628141  0.639482  0.650034  0.659798  0.668775  0.676965  0.684369  0.690988  0.696822  0.701873  0.70614  0.709624  0.712327  0.714249  0.71539  0.715752  0.715334  0.714138  0.712165  0.709414  0.705887  0.701585  0.696508  0.690656  0.684031  0.676633  0.668462  0.659521  0.649808  0.639325  0.628073  0.61613  0.60358  0.590335  0.576449  0.561975  0.546968  0.531481  0.515569  0.499285  0.482683  0.465818  0.448742  0.431511  0.414177  0.396796  0.37942  0.362103  0.3449  0.327865  0.311051  0.294513  0.278303  0.262477  0.247088  0.232189  0.217836  0.204081  0.190979  0.178584  0.166949  0.156466  0.147023  0.13836  0.130442  0.123235  0.116702  0.110809  0.105521  0.100804  0.0966219  0.0929399  0.0897232  0.0869368  0.0845458  0.0825151  0.0808098  0.0793949  0.0782356  0.0772967  0.0765433  0.0759405  0.0754533  0.0750468  0.0746859  0.0743357  0.0736837  0.0723051  0.0708858  0.0694327  0.0679523  0.0664512  0.0649362  0.0634138  0.0618907  0.0603735  0.0588689  0.0573835  0.0559239  0.0544968  0.0531089  0.0517667  0.0504769  0.0492462  0.0480812  0.0469868  0.0459586  0.044989  0.0440706  0.0431957  0.0423568  0.0415464  0.0407569  0.0399808];
plot(x,y,'b');

plot(dot_x,dot_y,'r--');

for i = 1:10
    plot(dot_x(i), dot_y(i), 'r.','MarkerSize', 10);
end

title('F2 Spline Interpolation Chebyshev grid');
legend({'y = 1/(1+25*x^2)', 'Spline', 'y = 1/(1+25*x^2), grid', 'Chebyshev grid n = 10'}, 'Location', 'southeast');

%  xlim ([-1.1 1.1]);
  ylim ([-0.1 1.1]);

grid on;
hold off

% Интерполяция сплайнами F2 Чебышевская сетка (n = 50)
figure;
dot_x=[-0.999507  -0.995562  -0.987688  -0.975917  -0.960294  -0.940881  -0.917755  -0.891007  -0.860742  -0.827081  -0.790155  -0.750111  -0.707107  -0.661312  -0.612907  -0.562083  -0.509041  -0.45399  -0.397148  -0.338738  -0.278991  -0.218143  -0.156434  -0.0941083  -0.0314108  0.0314108  0.0941083  0.156434  0.218143  0.278991  0.338738  0.397148  0.45399  0.509041  0.562083  0.612907  0.661312  0.707107  0.750111  0.790155  0.827081  0.860742  0.891007  0.917755  0.940881  0.960294  0.975917  0.987688  0.995562  0.999507];
dot_y=[0.0384981  0.0387919  0.0393884  0.0403058  0.041573  0.0432312  0.0453374  0.0479678  0.0512245  0.0552439  0.0602097  0.0663717  0.0740741  0.0837989  0.0962336  0.112379  0.133724  0.162531  0.2023  0.258492  0.339455  0.456692  0.620427  0.818726  0.975928  0.975928  0.818726  0.620427  0.456692  0.339455  0.258492  0.2023  0.162531  0.133724  0.112379  0.0962336  0.0837989  0.0740741  0.0663717  0.0602097  0.0552439  0.0512245  0.0479678  0.0453374  0.0432312  0.041573  0.0403058  0.0393884  0.0387919  0.0384981];

x = [-1:0.01:1];
y = 1./(1+25.*x.^2);
plot(x,y,'r');
hold on

x=[-1:0.01:0.99];
y=[0.0384614  0.0392118  0.0399842  0.040779  0.0415974  0.0424407  0.0433088  0.0442042  0.0451265  0.046078  0.0470593  0.0480712  0.0491164  0.050195  0.0513084  0.0524596  0.0536487  0.0548774  0.0561487  0.0574638  0.0588242  0.0602319  0.061691  0.0632021  0.0647676  0.0663901  0.0680743  0.0698213  0.0716342  0.0735162  0.0754724  0.0775055  0.079619  0.0818172  0.0841045  0.0864875  0.0889693  0.0915554  0.0942516  0.0970642  0.100001  0.103068  0.106271  0.10962  0.113123  0.116789  0.120628  0.124651  0.128867  0.133289  0.137932  0.142807  0.14793  0.153317  0.158984  0.164949  0.171233  0.177857  0.184843  0.192217  0.200001  0.208226  0.216919  0.226115  0.235848  0.246155  0.25707  0.268637  0.280897  0.293898  0.307689  0.322319  0.337838  0.354304  0.37176  0.390255  0.409841  0.430568  0.452486  0.475652  0.500058  0.525687  0.55252  0.580543  0.609737  0.640083  0.671386  0.703339  0.735639  0.767984  0.800068  0.831588  0.862106  0.891003  0.917657  0.941446  0.961748  0.97794  0.989553  0.996521  0.998844  0.996521  0.989554  0.97794  0.961754  0.941458  0.917672  0.891018  0.862118  0.831593  0.800072  0.767992  0.735649  0.703347  0.671391  0.640085  0.609735  0.580534  0.552507  0.525672  0.500045  0.475644  0.452484  0.430552  0.409818  0.39023  0.371738  0.354291  0.337836  0.322305  0.307668  0.293875  0.280878  0.268626  0.257068  0.246143  0.235831  0.226096  0.216904  0.208218  0.199998  0.192206  0.184829  0.177842  0.171223  0.164945  0.158979  0.153307  0.147919  0.142797  0.137926  0.133289  0.128862  0.124643  0.12062  0.116783  0.113121  0.109617  0.106265  0.103061  0.0999962  0.0970628  0.0942489  0.0915506  0.0889642  0.0864838  0.0841039  0.0818146  0.079615  0.0775017  0.0754702  0.0735154  0.0716314  0.069818  0.068072  0.06639  0.0647656  0.0631994  0.061689  0.0602319  0.0588225  0.0574617  0.0561474  0.0548769  0.0536471  0.0524581  0.0513083  0.0501938  0.0491151  0.048071  0.0470582  0.0460771  0.0451262  0.0442033  0.0433087  0.0424399  0.0415973  0.0407786  0.0399838  0.0392117];
plot(x,y,'b');

plot(dot_x,dot_y,'r--');

for i = 1:50
    plot(dot_x(i), dot_y(i), 'r.','MarkerSize', 10);
end

title('F2 Spline Interpolation Chebyshev grid');
legend({'y = 1/(1+25*x^2)', 'Spline', 'y = 1/(1+25*x^2), grid', 'Chebyshev grid n = 50'}, 'Location', 'southeast');

%   xlim ([-3.1 3.1]);
   ylim ([-0.1 1.1]);

grid on;
hold off
